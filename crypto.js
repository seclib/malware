
## uploaded by @satya_enki
## sample hash: 5c579e273d1eace7201a7bf637e25b92ab243909c6e6f1207f47b1e6abe0f7d0
(function(bX){var i=bX,k=bX,b=bX,d=bX,f=bX,g=bX,aR=bX,j=bX,c=bX,a=bX,h=bX,aK=aI(),aO="winmgmts:",aF="{impersonationLevel=impersonate}",aC=2147483648,aD=2147483649,aE=2147483650,bj="HKCU\\",bk="HKLM\\",bw="Software\\",bx=bw+"Wow6432Node\\",bm="Microsoft\\",bl=bw+bm,u="CurrentVersion",a5=bl+"Cryptography\\Calais",a6=a5+"\\Readers",be=bl+"Windows\\"+u+"\\",bz=bl+"Windows NT\\"+u+"\\",a8=bz+"AppCompatFlags\\",a9=a8+"Layers\\",by="SYSTEM\\CurrentControlSet\\",ba=by+"Control\\",bv=by+"Services\\",bc=bw+"Crypto Pro",bb=bc+"\\Cryptography\\"+u+"\\Parameters\\",bd=bc+"\\Settings",aZ="REG_BINARY",a0="REG_DWORD",a1="REG_EXPAND_SZ",a2="REG_MULTI_SZ",a3="REG_QWORD",a4="REG_SZ",bT=0,H=252,J=253,I=254;function F(b5,e,b4){this.description=b5;this.message=b5;this.code=e;this.number=e;this.innerError=b4}F.prototype={prototype:Error.prototype,constructor:F,name:"NumberedError"};function av(e){return(e!==null)?new VBArray(e).toArray():null}function aq(e){return(aE==e)?bk:bj}var aS=new RegExp("^(\\\\)+"),aT=new RegExp("(\\\\)+$");function m(e,b4){if(!e||!b4){return""}return e.replace(aT,"")+"\\"+b4.replace(aS,"")}function s(e){return(new Function(["return new ","Activ",'eXObject("'].join("")+e.join(".")+'")'))()}function at(){if(i===bX){try{i=s(["Shell","Application"])}catch(e){i=null}}return i}function ax(){if(k===bX){try{k=s(["WScript","Shell"])}catch(e){k=null}}return k}function ai(){if(b===bX){try{b=s(["Scripting","FileSystemObject"])}catch(e){b=null}}return b}function am(b6){if(b6||f===bX){var cd="StdRegProv",e=function(cf){cf.CheckAccess(aD,"Software")};try{var ce=s(["WbemScripting","SWbemLocator"]),cc=ce.ConnectServer("","root\\default","","","MS_0419");cc.Security_.ImpersonationLevel=3;f=cc.Get(cd)}catch(b4){var b9=["//./root/default:",cd].join(""),ca=["\\\\.\\root\\default:",cd].join(""),b8=[aO+aF+b9,aO+aF+ca,aO+aF+"!"+b9,aO+aF+"!"+ca,aO+b9,aO+ca,aO+"!"+b9,aO+"!"+ca];for(var b7=0,cb=b8.length;b7<cb;++b7){try{f=GetObject(b8[b7]);e(f);break}catch(b5){f=null}}}}return f}function an(b4){if(b4||g===bX){try{aR=s(["WbemScripting","SWbemNamedValueSet"]);aR.Add("__ProviderArchitecture",64);var b5=s(["WbemScripting","SWbemLocator"]),b6=b5.ConnectServer("","root\\default","","","MS_0419",null,null,aR);b6.Security_.ImpersonationLevel=3;g=b6.Get("StdRegProv")}catch(e){g=null;aR=null}}return g}function aw(){if(j===bX){var e=function(cd){var cc=["SELECT * FROM Win32_Opera","tingSystem"].join(""),ce=cd.ExecQuery(cc,"WQL",48);return new Enumerator(ce)};try{var b7=s(["WbemScripting","SWbemLocator"]);j=b7.ConnectServer("","root\\cimv2","","","MS_0419");j.Security_.ImpersonationLevel=3}catch(b4){var ca="//./root/cimv2",cb="\\\\.\\root\\cimv2",b9=[aO+aF+ca,aO+aF+cb,aO+aF+"!"+ca,aO+aF+"!"+cb,aO+ca,aO+cb,aO+"!"+ca,aO+"!"+cb];for(var b6=0,b8=b9.length;b6<b8;++b6){try{j=GetObject(b9[b6]);e(j);break}catch(b5){j=null}}}}return j}function ae(){try{return s(["ADODB","Stream"])}catch(e){return null}}function bZ(b7,b6,e){var b4=[];for(var b5=0;b5<e;++b5){b4.push("arguments["+b5+"]")}return new Function("o","return function(){ return o."+b6+"("+b4.join(",")+");}")(b7)}function ao(){var e=ak();return e&&e.registryWorker}function K(b4){try{return ax().ExpandEnvironmentStrings(b4)}catch(e){return ak().environmentWorker.expandVariable(b4)}}function al(e){if((e||d===bX)&&(ak()||ax())){var b6={"$AllUsers":["%ALLUSE","RSPROFILE%"],"$AppData":["%APP","DATA%"],"$Arch":["%PROCESSOR_","ARCHITECTURE%"],"$Cmd":["%Com","Spec%"],"$ComPFiles":["%Common","Program","Files%"],"$ComPFiles86":["%Common","Program","Files(x86)%"],"$CompName":["%Computer","Name%"],"$PFiles":["%Program","Files%"],"$PFiles86":["%Program","Files(x86)%"],"$PFiles64":["%Program","W6432%"],"$SystemDrive":["%System","Drive%"],"$Temp":["%TE","MP%"],"$UserDNSDomain":["%USERDNS","DOMAIN%"],"$UserDomain":["%USER","DOMAIN%"],"$UserName":["%USER","NAME%"],"$UserProfile":["%USER","PROFILE%"],"$Windows":["%System","Root%"]};d={};for(var b5 in b6){d[b5]=K(b6[b5].join(""))}var b7=d.$Windows,b4=["Internet ","Explorer"].join("");d["$IE"]=m(d.$PFiles,b4);d["$IE86"]=m(d.$PFiles86,b4);d["$SysNative"]=m(b7,["Sys","Native"].join(""));d["$System32"]=m(b7,["Sys","tem32"].join(""));d["$SysWOW64"]=m(b7,["Sys","WOW64"].join(""));d["$SysTemp"]=m(b7,["Te","mp"].join(""))}return d}function ag(b8){if(!b8){return{}}var cd=b8.lastIndexOf("\\"),cc=b8.substr(cd+1),b9=(cd>0)?b8.substr(0,cd+1):"",e=cc.lastIndexOf("."),b6=(e>0)?cc.substr(e+1).toLowerCase():"",b7={ext:b6,exist:false,folder:b9};try{var ca=ai();if(!ca){throw new Error()}if(ca.FileExists(b8)){b7.exist=true;try{b7.size=b.GetFile(b8).Size}catch(b5){}}b7.copy=function(ce){if(ca.FileExists(ce)){ca.DeleteFile(ce,true)}ca.CopyFile(b8,ce,true);return this};b7.remove=function(){if(ca.FileExists(b8)){ca.DeleteFile(b8,true);this.exist=false}return this};return b7}catch(b4){}var cb=ak();if(cb){if(cb.isFileExist(b8)){b7.exist=true;try{b7.size=c.getFileObject(b8).size}catch(b4){}}b7.copy=function(ce){if(cb.isFileExist(ce)){cb.deleteFile(ce)}cb.getFileObject(b8).copyTo(ce);return this};b7.remove=function(){if(cb.isFileExist(b8)){cb.deleteFile(b8);this.exist=false}return this}}return b7}function ah(b6){if(!b6){return{}}if(b6.charAt(b6.length-1)=="\\"){b6=b6.substr(0,b6.length-1)}var ca=b6.lastIndexOf("\\"),b9=~ca?b6.substr(0,ca+1):"";var b5={exist:false,parent:b9};try{var b7=ai();if(!b7){throw new Error()}b5.exist=b7.FolderExists(b6);b5.create=function(){if(!b7.FolderExists(b6)){b7.CreateFolder(b6);this.exist=true}return this};b5.remove=function(){if(b7.FolderExists(b6)){b7.DeleteFolder(b6,true);this.exist=false}return this};return b5}catch(b4){}var b8=ak(),e=b8&&b8.directoryWorker;if(e){b5.exist=e.isExist(b6);b5.create=function(){if(!e.isExist(b6)){e.create(b6);this.exist=true}return this};b5.remove=function(){if(e.isExist(b6)){e.remove(b6);this.exist=false}return this}}return b5}function aj(){return WScript.ScriptFullName}function af(){return ag(aj()).folder}function b0(b8,b4,b9){try{ak().getTextFileObject(b8).write(b4,b9?1200:1251)}catch(b5){var ca=ae();if(ca){ca.Mode=3;ca.Type=2;ca.Open();ca.Charset=b9?"utf-16":"windows-1251";ca.WriteText(b4);if(b9){ca.Position=2;var e=ae();e.Mode=3;e.Type=1;e.Open();ca.CopyTo(e);ca.Flush();try{ca.Close()}catch(b6){}e.SaveToFile(b8,2);e.Flush();try{e.Close()}catch(b6){}}else{ca.SaveToFile(b8,2);try{ca.Close()}catch(b6){}}}else{if(ai()){var b7=ai().OpenTextFile(b8,2,true,b9?-1:0);b7.Write(b4);b7.Close()}else{throw b5}}}}function aW(b7){try{return ak().getTextFileObject(b7).readAll(1200)}catch(b4){var b8=ae();if(b8){b8.Type=2;b8.Charset="Unicode";b8.Open();b8.LoadFromFile(b7);var e=b8.ReadText(-1);try{b8.Close()}catch(b5){}return e}else{if(ai()){var b6=ai().OpenTextFile(b7,1,false,-1),b9=b6.ReadAll();b6.Close();return b9}else{throw b4}}}}function bJ(b9,e,cd,cb,b4){e=e?(" "+e):"";var b8=null;try{var ce=ax();if(b4){b8=ce.CurrentDirectory;ce.CurrentDirectory=b4}var ca=ce.Run('"'+b9+'"'+e,cb?1:0,cd?1:0);if(b8){try{ce.CurrentDirectory=b8}catch(b6){}}return ca}catch(b5){try{var b7=ak(),cc=b7.startProcess(b9,e,b4||"",!!cb,!!cd,true,false);return cc.exitCode}catch(b6){return -1}}}function au(e,b6){var b8;try{try{b8=ax().SpecialFolders((e?"AllUsers":"")+"Startup");if(!ah(b8).exist){throw F("Folder not found: "+b8,2)}}catch(b5){b8=ak().getShellFolder(e?24:7);if(!ah(b8).exist){throw F("Folder not found: "+b8,2)}}}catch(b4){var b7=al()[e?"$AllUsers":(b6?"$UserProfile":"$AppData")];b7+=b6?"":"Microsoft\\Windows\\";b8=m(b7,"Start Menu\\Programs\\Startup\\");if(!ah(b8).exist){b8=m(b7,"\u0413\u043B\u0430\u0432\u043D\u043E\u0435 \u041C\u0435\u043D\u044E\\\u041F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u044B\\\u0410\u0432\u0442\u043E\u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0430\\");if(!ah(b8).exist){return null}}}return b8}function b2(b4,b5,b6){if(!ag(b4).exist){try{var b7=b5;if(b6){b7+="\r\n"+b6}else{if(b5==J){b7+="\r\nCould not create WS"}}b0(b4,b7)}catch(e){}}}function aM(e){if(e instanceof Array){e=e.join(" /PID ")}var b4=m(al().$System32,"taskkill.exe");return bJ(b4,"/PID "+e+" /T /F",1)}function aI(){try{var e=(K("%PROCESSOR_ARCHITECTURE%")||"").toUpperCase();if("AMD64"==e){return true}var b4=(K("%PROCESSOR_ARCHITEW6432%")||"").toUpperCase();if("AMD64"==b4){return true}throw new Error()}catch(b5){return ah(al().$SysWOW64).exist}}function ap(b4,e,b5){return aq(b4)+(e||"").replace(aT,"")+"\\"+(b5||"")}function n(b5,e,cc,cb,ce){var b9=ce?an():am(),b7=b9.Methods_.Item(b5).InParameters.SpawnInstance_(),b8;b7.hDefKey=e;b7.sSubKeyName=cc;if(cb){b7.sValueName=cb}try{if(ce&&aR){b8=b9.ExecMethod_(b5,b7,null,aR)}else{b8=b9.ExecMethod_(b5,b7)}}catch(b4){return cb?null:[]}var ca=b8.ReturnValue;if(ca&&(-1!=ca)){var b6="Error call "+(ce?"x64:":"x32:")+b5;throw new F(b6+" ("+ap(e,cc,cb)+") - error code "+ca,ca)}function cd(ch){try{var cf=ch.toArray();return cf||[]}catch(cg){return[]}}if(cb){if("GetMultiStringValue"===b5){return cd(b8.sValue)}if("GetStringValue"===b5||"GetExpandedStringValue"===b5){return b8.sValue}return b8.uValue}return cd(b8.sNames)}function aJ(e){return e&&(e.number===-2147024894||e.number===2147942402||e.number===2)}function a7(e,b4){if(b4||(e&&~e.indexOf("\\"))){throw F("isX64 or Value has \\",1)}}function bo(b4,b6,b5,b7){try{a7(b7);return ax().RegRead(ap(b6,b5,b7))}catch(e){if(e&&(!e.number||aJ(e))){throw e}return n(b4,b6,b5,b7,false)}}function bp(e,b5,b4,b6){return n(e,b5,b4,b6,true)}function bn(e,b5,b4,b6,b7){return(b7?bp:bo)(e,b5,b4,b6)}function br(b5,b4,b6,b7){try{return ao().getDwordValue(b5,b4,b6,!!b7)}catch(e){return bn("GetDWORDValue",b5,b4,b6,b7)}}function bs(b6,b5,b7,b8){try{a7(b7,b8);return ax().RegRead(ap(b6,b5,b7))}catch(e){try{return ao().getStrValue(b6,b5,b7,!!b8)}catch(b4){return n("GetStringValue",b6,b5,b7,b8)}}}function bq(b6,b5,b7,b8){try{return av(ao().getMultiStrValue(b6,b5,b7,!!b8))}catch(b4){return bn("GetMultiStringValue",b6,b5,b7,b8)}}function bA(cc,b9,ce,cd,cg){try{ao().setBinValue(cc,b9,ce,cd,!!cg)}catch(e){try{var b8=ap(cc,b9,""),cf=ax();try{cf.RegRead(b8)}catch(b4){try{cf.RegWrite(b8,"",a4)}catch(b5){}}cf.RegWrite(ap(cc,b9,ce),cd,aZ)}catch(b6){var ca=cg?an():am();try{ca.CreateKey(cc,b9)}catch(b7){}var cb=ca.SetBinaryValue(cc,b9,ce,cd);if(cb!==0){throw new F("SetBinaryValue",cb,b6)}}}}function bE(cc,b9,ce,cd,cg){try{ao().setDwordValue(cc,b9,ce,cd,!!cg)}catch(e){try{a7(ce,cg);var b8=ap(cc,b9,""),cf=ax();try{cf.RegRead(b8)}catch(b5){try{cf.RegWrite(b8,"",a4)}catch(b6){}}cf.RegWrite(ap(cc,b9,ce),cd,a0)}catch(b4){var ca=cg?an():am();try{ca.CreateKey(cc,b9)}catch(b7){}var cb=ca.SetDWORDValue(cc,b9,ce,cd);if(cb!==0){throw new F("regWriteNumber",cb,b4)}}}}function bG(cc,b9,ce,cd,cg){try{ao().setStrValue(cc,b9,ce,cd,!!cg)}catch(e){try{a7(ce,cg);var b8=ap(cc,b9,""),cf=ax();try{cf.RegRead(b8)}catch(b5){try{cf.RegWrite(b8,"",a4)}catch(b6){}}cf.RegWrite(ap(cc,b9,ce),cd,a4)}catch(b4){var ca=cg?an():am();try{ca.CreateKey(cc,b9)}catch(b7){}var cb=ca.SetStringValue(cc,b9,ce,cd);if(cb!==0){throw new F("regWriteString",cb,b4)}}}}function bB(ca,b6,cc,cb,b9,b5){var b7=m(al().$System32,"reg.exe"),b8=ap(ca,b6,"").replace(aT,""),e='add "'+b8+'" /v "'+cc+'" /t '+b9+" /d "+cb+" /f",b4=bJ(b7,e,1);if(0!==b4){throw new F("regWriteCmd",b4,b5)}}function bD(b9,b6,cb,ca,cc){try{ao().setMultiStrValue(b9,b6,cb,ca,!!cc)}catch(e){try{var b7=cc?an():am();try{b7.CreateKey(b9,b6)}catch(b5){}var b8=b7.SetMultiStringValue(b9,b6,cb,ca);if(b8!==0){throw new F("regWriteMultiString",b8,e)}}catch(b4){bB(b9,b6,cb,'"'+ca.join("\\0")+'"',a2,b4)}}}function bF(b8,b5,ca,b9,cb){try{var b6=cb?an():am();try{b6.CreateKey(b8,b5)}catch(b4){}var b7=b6.SetQWORDValue(b8,b5,ca,b9.toString());if(b7!==0){throw new F("regWriteQWord",b7)}}catch(e){bB(b8,b5,ca,b9.toString(),a3,e)}}function bC(cc,b9,ce,cd,cg){try{ao().setExStrValue(cc,b9,ce,cd,!!cg)}catch(e){try{a7(ce,cg);var b8=ap(cc,b9,""),cf=ax();try{cf.RegRead(b8)}catch(b5){try{cf.RegWrite(b8,"",a4)}catch(b6){}}cf.RegWrite(ap(cc,b9,ce),cd,a1)}catch(b4){var ca=cg?an():am();try{ca.CreateKey(cc,b9)}catch(b7){}var cb=ca.SetExpandedStringValue(cc,b9,ce,cd);if(cb!==0){throw new F("regWriteExpandString",cb,b4)}}}}function bf(b6,b4,b9){try{ao().deleteKey(b6,b4,!!b9)}catch(e){var b5=(b9?an():am()).DeleteKey(b6,b4);if(b5!==0){if(b9){throw new F("regDeleteKey",b5,e)}try{ax().RegDelete(ap(b6,b4,""))}catch(b8){var b7=b8.number||b8.code;if(b7===-2147024894||b7===2147942402){b7=2}throw new F("regDeleteKey",b7,e)}}}}function bg(b7,b5,b8,b9){try{ao().deleteValue(b7,b5,b8,b9)}catch(e){try{a7(b8,b9);ax().RegDelete(ap(b7,b5,b8))}catch(b4){var b6=(b9?an():am()).DeleteValue(b7,b5,b8);if(b6!==0){throw new F("regDeleteValue",b6,e)}}}}function bh(b5,b4,b6){try{return av(ao().enumKeys(b5,b4,b6))}catch(e){return n("EnumKey",b5,b4,null,b6)}}function bi(b5,b4,b6){try{return av(ak().enumValues(b5,b4,b6))}catch(e){return n("EnumValues",b5,b4,null,b6)}}function z(b7){if(!ax()&&!ak()){return J}var ca="Popup\\",cc;try{cc=br(aD,ca,"ManagerON",false);if(cc!==null){bE(aD,ca,"ManagerON",0,false)}}catch(e){}ca=bw+"XTTB00001\\Toolbar\\";try{cc=br(aD,ca,"blockPopups",false);if(cc!==null){bE(aD,ca,"blockPopups",0,false)}}catch(e){}ca=bw+"torrapps\\toolbar\\Settings\\options\\104\\";try{cc=br(aD,ca,"104",false);if(cc!==null){bE(aD,ca,"104","false",false)}}catch(e){}ca=be+"Ext\\Settings\\";var b6=b7.split(new RegExp(",","g")),b4=null;function cb(cd,cg,ce){var cf=ca+cd+"\\";try{bG(cg,cf,"","",ce);bE(cg,cf,"Flags",1,ce);bG(cg,cf,"Version","*",ce)}catch(ch){b4=ch?ch.number:1}}for(var b8=0,b9=b6.length;b8<b9;++b8){var b5=b6[b8];cb(b5,aD,false);cb(b5,aE,false);if(aK){cb(b5,aE,true)}}return b4||bT}function M(){if(!ax()&&!ak()){return J}var ca=0,e=new RegExp("^\\s*(User[\\-\\s]*agent|Mazilla|Opera|Mozilla|Gecko/|Version$|Platform$)","i"),b6=be+"Internet Settings\\",b8="User Agent\\",b9="5.0\\"+b8,b7="Post Platform\\",b4=[b6+b8,b6+b9,b6+b8+b7,b6+b9+b7];function b5(cl,cb){var cj=null,cc=function(co){if(!cj||!cj.number){cj=co}};for(var cf=0,cg=b4.length;cf<cg;++cf){var ck=b4[cf];try{var cn=bi(aE,ck,cb);if(cn&&cn.length){for(var ch=0,ci=cn.length;ch<ci;++ch){var cm=cn[ch];if(cm&&e.test(cm)){try{bg(aE,ck,cm,cb)}catch(cd){cc(cd)}}}}}catch(ce){cc(ce)}}return cj?(cj.number||1):0}if(aK){ca=b5(aE,true)||ca}ca=b5(aE,false)||ca;ca=b5(aD,false)||ca;return ca}function aH(cc,b9,ca){if(!ax()&&!ak()){return J}var cb=be+"Installer\\UserData\\"+(cc||"S-1-5-18")+"\\Products\\",b8=cb+b9+"\\InstallProperties\\",b7="";try{b7=bs(aE,b8,"LocalPackage",aK)}catch(e){}if(!b7||!ag(b7).exist){return 1}var b6="";try{b6=bs(aE,b8,"InstallSource",aK)}catch(e){}if(!b6){return 1}if("\\\\"==b6.substr(0,2)){var b4=ca.lastIndexOf("\\");b6=(b4<1)?ca:ca.substr(0,b4+1);try{bG(aE,b8,"InstallSource",b6,aK)}catch(e){}}var b5=ah(b6);if(!b5.exist){try{b5.create()}catch(e){}}if(ah(ca).exist){return bT}try{ag(b7).copy(ca);return bT}catch(e){return 1}}function bH(e){e=e.replace("/qb ","/passive ").replace("/q ","/quiet ").replace("/i ","/package ");return e.replace(new RegExp("\\s\\/l[\\*vx]*\\s","i")," /log ")}function bK(cf,cg){if(!ax()&&!ak()){return J}if(!ag(cf).exist){return 1}var ch=-1,b8=ag(cf).ext.toLowerCase(),ci;try{ci=ai().GetFile(cf).ShortPath||cf}catch(b6){ci=cf}var b9=ci+".log",ca=m(al().$System32,"msiexec.exe");cg=cg?(" "+cg.replace("${LOGFILE}",'"'+b9+'"')):"";cg=cg.replace("${EMPTYSTRING}",'""');switch(b8){case"msi":cg=cg.replace(new RegExp("'","g"),'"');var cb=(cg&&(new RegExp("/q|/passive","i")).test(cg))?"":"/qb ",cc=" APPCONFLICT=IGNORE MSIRESTARTMANAGERCONTROL=Disable REBOOT=ReallySuppress",b7=cb+'/norestart /i "'+cf+'"'+cg+cc;ch=bJ(ca,b7,1,1);if(ch==1639){var cd=bH(b7);if(cd!=b7){ch=bJ(ca,cd,1,1)}}break;case"msp":ch=bJ(ca,'/qr /norestart /update "'+cf+'"'+cg,1,1);break;case"msu":ch=bJ("wusa.exe",'"'+cf+'" /quiet /norestart'+cg,1,1);break;case"exe":var b5=new RegExp("(\u0423\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0430 \u0441 \u0441\u043E\u0441\u0442\u043E\u044F\u043D\u0438\u0435\u043C\\:|MainEngineThread is returning|\\-\\- \u041E\u0448\u0438\u0431\u043A\u0430|\\-\\- Error)\\s*([a-fhx\\d\\-]+)","i");cg=cg.replace(new RegExp("\\'","g"),'"');ch=-1;ch=bJ(cf,cg,1,1);if(ch==1639){var ce=bH(cg);if(ce!=cg){ch=bJ(cf,ce,1,1)}}break;default:break}try{b2(ci+".txt",ch,null)}catch(e){}try{b2(cf+".txt",ch,null)}catch(b4){}return(3010==ch)?bT:ch}function ar(){var b4=bu(),e=al()[(aK&&(b4>=6))?"$SysNative":"$System32"];return m(e,"sc.exe")}function y(b4){if(!ax()&&!ak()){return J}try{return bJ(ar(),'delete "'+b4+'"',1)}catch(e){return e?e.number:1}}function t(cA,b6){if(!ax()&&!ak()){return J}b6=b6||"";var co="(^|;;;)",cp="(;;;|$)",cm=b6.length;if((cm>1)&&('"'==b6.charAt(0))&&('"'==b6.charAt(cm-1))){b6=b6.substr(1,cm-2)}function cn(e,cO,cM){var cL=new RegExp(co+e+"=(.+?)"+cp,"i").exec(cO),cN=cL&&(cL.length>2)&&cL[2]||"";return cM?cN.replace(new RegExp("/","g"),"\\"):cN}function b4(cL,cM,cN,e){if(e||(cM&&cM.length)){cN+=" "+cL+'= "'+((cM||0===cM)?cM:"")+'"'}return cN}var b5=cn("binpath",b6,1),b7=cn("depend",b6),b8=cn("description",b6,1),b9=cn("displayname",b6,1),ce=cn("errorcontrol",b6,1),cf=cn("group",b6),cs=cn("requiredprivileges",b6),cC=cn("obj",b6,1),cx=cn("servicedll",b6,1),cz=cn("servicemain",b6),cD=cn("servicesidtype",b6),cE=cn("type",b6);try{var cr=by+"Services\\"+cA+"\\",cq=cr+"Parameters\\",cu=b4("binPath",b5,"");cu=b4("displayName",b9,cu);cu=b4("depend",b7,cu,true);cu=b4("group",cf,cu);cu=b4("obj",cC,cu);cu=b4("type",cE,cu);var cw=ar(),cH={kernel:1,filesys:2,own:16,share:32},cG=cE&&cH[cE],cv=bJ(cw,'create "'+cA+'"'+cu,1);if(1073==cv){cv=bJ(cw,'config "'+cA+'"'+cu,1)}var cI=(0===cv||2==cv);if(cI){if(b7&&b7.length){bD(aE,cr,"DependOnService",b7.split(new RegExp(",","g")))}else{try{bg(aE,cr,"DependOnService")}catch(ca){}}if(b8){bG(aE,cr,"Description",b8)}if(b9){bG(aE,cr,"DisplayName",b9)}if(ce||(0===ce)){bE(aE,cr,"ErrorControl",Number(ce))}if(cf){bG(aE,cr,"Group",cf)}if(b5){bC(aE,cr,"ImagePath",b5)}if(cC){bG(aE,cr,"ObjectName",cC)}if(cs&&cs.length){bD(aE,cr,"RequiredPrivileges",cs.split(new RegExp(",","g")))}if(cD||(0===cD)){bE(aE,cr,"ServiceSidType",Number(cD))}bE(aE,cr,"Start",2);if(cG){bE(aE,cr,"Type",cG)}var cK=bu();if(cK>=6){bC(aE,cq,"ServiceDll",cx);bE(aE,cq,"ServiceDllUnloadOnStop",1);bG(aE,cq,"ServiceMain",cz);var cJ=bz+"SvcHost\\",cl=(cK<6.1)?"LocalService":"LocalServiceAndNoImpersonation",cF;try{cF=bq(aE,cJ,cl,aK)}catch(cc){cF=[]}if(cF&&cF.length){var cy=false;if((1==cF.length)&&(cK>=6.3)&&("SCardSvr"===cF[0])&&(bt()>=10240)){try{var ct=bq(aE,cJ,"LocalServiceNetworkRestricted",aK),cg=false;if(ct&&ct.length){for(var cj=0,ck=ct.length;cj<ck;++cj){if("TimeBrokerSvc"===ct[cj]){cg=true;break}}}cF=(cg?[]:["TimeBroker"]).concat(["SSDPSRV","upnphost","SCardSvr","QWAVE","fdrespub","wcncsvc","SensrSvc","BthHFSrv"]);cy=true}catch(cd){}}if(!cy){var cB=false;for(var ch=0,ci=cF.length;ch<ci;++ch){if(cA==cF[ch]){cB=true;break}}if(!cB){cF.push(cA);cy=true}}if(cy){bD(aE,cJ,cl,cF,aK)}}}}return cI?0:cv}catch(cb){return cb&&cb.number||I}}function bR(ci,cc){if(!ax()&&!ak()){return J}cc=cc||"";if((cc.length>1)&&('"'==cc.charAt(0))&&('"'==cc.charAt(cc.length-1))){cc=cc.substr(1,cc.length-2)}var cf="(^|;;;)",cg="(;;;|$)",b9=new RegExp(cf+"manual"+cg,"i").test(cc),ch=new RegExp(cf+"restart"+cg,"i").test(cc),b4=new RegExp(cf+"account=(.+?)"+cg,"i").exec(cc),e=(b4&&(b4.length>1)&&b4[1]||"").replace("/","\\"),cd=new RegExp(cf+"password=(.+?)"+cg,"i").exec(cc),ce=cd&&(cd.length>1)&&cd[1]||"",cm=60000,cl=1000;function b8(cp){var cq="SELECT * FROM Win32_Service WHERE Name='"+cp+"'",cr=aw().ExecQuery(cq,"WQL",48);for(var co=new Enumerator(cr);!co.atEnd();co.moveNext()){return co.item()}throw F("Service "+cp+" not found",2)}function ck(cs){var cw=b8(cs),cx=cw.State.substr(0,3).toLowerCase(),cr=cw.StartMode.substr(0,4).toLowerCase(),cp=("auto"===cr);if(ch&&("run"===cx)){var cy=cw.StopService();if(0!==cy){throw F("StopService "+cs,cy)}var cz=cm;while(cz>0){var ct=b8(cs),cu=ct.State.toLowerCase();if("stopped"==cu||"stop"==cu){cw=ct;break}cz-=cl;WScript.Sleep(cl)}cx="stop";ch=false}if(b9&&!cp&&"manu"!=cr){var cq=cw.ChangeStartMode("Manual");if(0!==cq){throw F("setManual "+cs,cq)}}else{if(!cp){var co=cw.ChangeStartMode("Automatic");if(0!==co){throw new Error("setAuto "+cs,co)}}}if(e&&e.length){if(0!==cw.Change(bX,bX,bX,bX,bX,bX,e,ce)){throw new Error("setAccount "+e+" for "+cs)}}if("run"!=cx){var cv=cw.StartService();if(0!==cv){throw F("StartService "+cs,cv)}}return bT}if(ci=="wuauserv"){try{bE(aE,be+"WindowsUpdate\\Auto Update\\","AUOptions",2,aK)}catch(b6){}}try{return ck(ci)}catch(b6){try{var cj=at();if(!cj.CanStartStopService(ci)){throw F("Access denied to start/stop service "+ci,5)}if(ch&&cj.IsServiceRunning(ci)){if(!cj.ServiceStop(ci,false)){throw F("Error stop service "+ci,8)}var cn=cm;while(cn>0){if(!cj.IsServiceRunning(ci)){break}cn-=cl;WScript.Sleep(cl)}ch=false}if(e&&e.length){throw F("Account change not implemented",1)}if(!cj.IsServiceRunning(ci)){if(!cj.ServiceStart(ci,true)){throw F("Error start service",8)}}return bT}catch(b7){var ca=bT,cb=m(al().$System32,"net.exe");if(ch){ca=bJ(cb,'stop /y "'+ci+'"',1)}var b5=" start= "+(b9?"demand":"auto");if(e&&e.length){b5+=' obj= "'+e+'"';if(ce&&ce.length){b5+=' password= "'+ce+'"'}}ca|=bJ(ar(),'config "'+ci+'"'+b5,1);ca|=bJ(cb,'start "'+ci+'"',1);return ca}}}function r(b6,e){var b4=t(b6,e);if(0!==b4){return b4}if(b6=="SCardSvr"){var b5=bv+"SCardSvr\\";try{bg(aE,b5,"WOW64",false)}catch(b7){}}return bR(b6,e)}function bS(b7){function b9(cc){var cg=aw(),cd="SELECT * FROM Win32_Service WHERE Name='"+cc+"'",cf=cg.ExecQuery(cd,"WQL",48);for(var cb=new Enumerator(cf);!cb.atEnd();cb.moveNext()){var ce=cb.item();if("disa"!=ce.StartMode.substr(0,4).toLowerCase()){ce.ChangeStartMode("Disabled")}if("run"==ce.State.substr(0,3).toLowerCase()){if(0!==ce.StopService()){if(!ce.ProcessId){throw new Error("StopService")}if(0!==aM(ce.ProcessId)){throw new Error("TaskKill")}}}}return bT}if(!ax()&&!ak()){return J}try{return b9(b7)}catch(e){try{var b8=at();if(b8.IsServiceRunning(b7)){if(!b8.CanStartStopService(b7)){throw F("Access denied to start/stop service",5)}if(!b8.ServiceStop(b7,true)){throw F("Error stop service",8)}}return bT}catch(b4){var ca=al().$System32,b5=m(ca,"net.exe"),b6=m(ca,"sc.exe");bJ(b6,'config "'+b7+'" start= disabled',1);return bJ(b5,'stop /y "'+b7+'"',1)}}}function o(cc,b9){var ca="MSXML2",b4="DOMDocument",cg=[[ca,b4,"6.0"],[ca,b4,"5.0"],[ca,b4,"4.0"],[ca,b4,"3.0"],[ca,b4],["Microsoft","XMLDOM"]];function b8(cl){var cm=F("No errors",0);for(var cj=0,ck=cg.length;cj<ck;++cj){try{var cp=cg[cj],co=s(cp);try{co.async=cl||false}catch(ci){}if(cj>0){var cn=cg[0];cg[0]=cp;cg[cj]=cn}return co}catch(ch){cm=ch}}throw cm}function cf(ci,cm,ck){try{var cl=b8();cl.load(ci);var cj=cl.selectNodes(cm);if(!cj||!cj.length){return false}if(ck==cj.item(0).xml){return true}cj.item(0).text=ck;cl.save(ci);return true}catch(ch){return false}}if(!ax()&&!ak()){return J}if(!ai()&&!ak()){return H}var e="DefaultInstance",b7=bw+"Firebird Project\\Firebird Server\\Instances\\",cb=false;try{bs(aE,b7,e,false);try{bg(aE,b7,e,false);cb=true}catch(b6){return 1}}catch(b5){}if(aK){try{bs(aE,b7,e,aK);try{bg(aE,b7,e,aK);cb=true}catch(b6){return 1}}catch(b5){}}if(!cb){return bT}var ce=m(b9,"KELite.Core.dll.setting"),cd=false;if(ag(ce).exist){cd=cf(ce,"setting/DbSetting/DbPort",30303)}return(bR(cc,"restart")&&cd)?bT:2}function bO(cL,cO,cN,cj){function cJ(cQ){return cQ.split("").reverse().join("")}function cK(cQ){cQ=cQ.replace(new RegExp("[}{]","g"),"");var cS=cJ(cQ.substr(0,8));cS+=cJ(cQ.substr(9,4));cS+=cJ(cQ.substr(14,4));cS+=cJ(cQ.substr(19,2));cS+=cJ(cQ.substr(21,2));for(var cR=24;cR<36;cR+=2){cS+=cJ(cQ.substr(cR,2))}return cS}if(!ax()&&!ak()){return J}if(!ai()&&!ak()){return H}var cs=be+"Installer\\UserData\\S-1-5-18\\Products\\",cq="\\InstallProperties\\",ck="{54A08450-B343-40B0-924E-68F031450996}",cl="{39D25A86-A5E6-42FC-9C8F-EFA4C138B08C}",cm="{407E5BA7-6406-40BF-A4DC-3654B8F584C1}",cn="{50F91F80-D397-437C-B0C8-62128DE3B55E}",ct="{8CFC80FA-6524-437E-854A-0AF1790FE280}",cv="{F8DCE222-4388-468D-A174-97669AA8C3FF}",b8="3636740030EMPWPC6617NT3DY",b9="39390Z0037EA3YGGRQEDE6LPZ",ca="4040EG0037EK8R3C6K4UHCXQG",cb="5050KP003002VB57EPR09NCZH",cc="0510ME003000PQUAK8P3EP2MR",cd="0520VD00300063Y7EQNV339UN",cM=cL&&(cL.length>4)?cL.substr(2,2):"",b6=("50"==cM),b5=("40"==cM),b4=("39"==cM),cD=("10"==cM),co=cj?(cD?ct:cv):(b6?cn:(b5?cm:(b4?cl:ck))),b7=cj?(cD?cc:cd):(b6?cb:(b5?ca:(b4?b9:b8))),cx=cs+cK(ck)+cq,cy=cs+cK(cl)+cq,cz=cs+cK(cm)+cq,cA=cs+cK(cn)+cq,cu=cs+cK(ct)+cq,cw=cs+cK(cv)+cq,cr=cj?(cD?cu:cw):(b6?cA:(b5?cz:(b4?cy:cx))),cp="ProductID",cB;function ci(){var cQ,cT,cU=cj||b4||b5||b6;try{cQ=s(["CPCSPLicense","CPCSPLicense"]);try{cT=new Date(cQ.GetExpireDate(co))}catch(cS){if(cU){throw F("OffSig and CSP39+ have no empty interface",1)}cT=new Date(cQ.GetExpireDate())}}catch(cR){cQ=s(["CPCSPLicence","CPCSPLicence"]);try{if(cU){throw F("OffSig and CSP39+ have no empty interface",1)}cT=new Date(cQ.GetExpireDate())}catch(cS){cT=new Date(cQ.GetExpireDate(co))}}return cT}function cH(){var cR="";try{cR=bs(aE,cr,cp,aK);if(!cR||!cR.length){throw F("Serial is empty",1)}}catch(cQ){if(!aK){throw cQ}cR=bs(aE,cr,cp,false)}return cR}function cP(cQ){bG(aE,cr,cp,cQ,aK)}function e(cQ){return(cQ<10)?("0"+cQ):cQ}function ch(cR){var cS=cR.getHours(),cT=cR.getMinutes(),cU=cR.getSeconds(),cV=0===cS&&0===cT&&0===cU?"":(" "+[e(cS),e(cT),e(cU)].join(":")),cQ=[e(cR.getDate()),e(1+cR.getMonth()),cR.getFullYear()].join(".");return cQ+cV}function cG(cR,cS){if(!cB){if(cO&&cO.length&&ah(cO).exist){cB=cO}else{cB=ah(af()).parent}}var cQ=m(cB,"diagCSPLicenseResult.log");b0(cQ,cR+"\r\n"+cS)}var cF=b7,cE=null;function cI(cR){if(cF&&cF.length){try{cP(cF)}catch(cQ){}}cG("ERROR",cR)}try{cF=cH();cE=ci()}catch(ce){}try{cL=cL.toUpperCase();try{cP(cL);var cC=cH();if(cC!=cL){throw F("Postwrite serial check failed",1)}}catch(cf){cG("ERROR","\u0421\u0431\u043E\u0439 \u043F\u0440\u043E\u0432\u0435\u0440\u043A\u0438 \u043B\u0438\u0446\u0435\u043D\u0437\u0438\u0438. \u0423\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u0435 \u043B\u0438\u0446\u0435\u043D\u0437\u0438\u044E "+cL+' \u0432\u0440\u0443\u0447\u043D\u0443\u044E \u0447\u0435\u0440\u0435\u0437 <a href="#" onclick="window.SkbKontur.Help.runCryptoProPKI(); return false">\u041A\u0440\u0438\u043F\u0442\u043E\u041F\u0440\u043E PKI</a>.');return 2}var cg=ci();if(cN){cN=Number(cN)}if(!cN){cN=(new Date()).getTime()}if(cg.getTime()<=-2200000000000){cG("OK","\u041B\u0438\u0446\u0435\u043D\u0437\u0438\u044F \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0432\u0432\u0435\u0434\u0435\u043D\u0430. \u0421\u0440\u043E\u043A \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044F \u043D\u0435\u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D.");return bT}else{if(cg.getTime()-cN<=0){cI("\u0412\u0432\u0435\u0434\u0435\u043D\u043D\u0430\u044F \u043B\u0438\u0446\u0435\u043D\u0437\u0438\u044F \u0438\u0441\u0442\u0435\u043A\u043B\u0430 "+ch(cg));return 1}else{if(cE&&!isNaN(cE)&&cE.getTime()>=cg.getTime()){cI("\u041B\u0438\u0446\u0435\u043D\u0437\u0438\u044F, \u043A\u043E\u0442\u043E\u0440\u0430\u044F \u0431\u044B\u043B\u0430 \u0432\u0432\u0435\u0434\u0435\u043D\u0430 \u0440\u0430\u043D\u0435\u0435 (\u0441\u0440\u043E\u043A\u043E\u043C \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044F - \u0434\u043E "+ch(cE)+"), \u0442\u0430\u043A\u0430\u044F \u0436\u0435 \u0438\u043B\u0438 \u0430\u043A\u0442\u0443\u0430\u043B\u044C\u043D\u0435\u0435 \u0432\u0432\u0435\u0434\u0435\u043D\u043D\u043E\u0439 \u0432 \u0442\u0435\u043A\u0443\u0449\u0438\u0439 \u043C\u043E\u043C\u0435\u043D\u0442 (\u0441\u0440\u043E\u043A\u043E\u043C \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044F - \u0434\u043E "+ch(cg)+").");return 1}else{cG("OK","\u041B\u0438\u0446\u0435\u043D\u0437\u0438\u044F \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0432\u0432\u0435\u0434\u0435\u043D\u0430. \u0421\u0440\u043E\u043A \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044F - \u0434\u043E "+ch(cg));return bT}}}}catch(ce){cI("\u041E\u0448\u0438\u0431\u043A\u0430 \u0432\u0432\u043E\u0434\u0430 \u043B\u0438\u0446\u0435\u043D\u0437\u0438\u0438. \u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437.");return 1}}function bM(e,b5,b4){return bO(e,b5,b4,false)}function bP(e,b5,b4){return bO(e,b5,b4,true)}function aG(ca,b5){if(!ax()&&!ak()){return J}if(!ai()&&!ak()){return H}var b9=m(af(),ca),b8='/s "'+b9+'"',b7='import "'+b9+'"',b4=al(),cd=b4.$Windows,cc=aK?b4.$SysWOW64:null,b6=m(cc||b4.$System32,"reg.exe"),e=ag(b6).exist,cb;if(e){cb=bJ(b6,b7,1)}else{cb=bJ(m(cc||cd,"regedit.exe"),b8,1)}if(b5&&aK){if(e){cb+=bJ(b6,b7+" /reg:64",1)}else{cb+=bJ(m(cd,"regedit.exe"),b8,1)}}return cb}function T(){return aG("random.reg",false)}function U(){return aG("readers.reg",false)}function O(ce,b8){ce=Number(ce);if(ce<0||ce>2){return 3}if(!ax()&&!ak()){return J}function b6(cf){return b8||[7,15,9][cf]||4}function e(ck){var cf=[],ci=[10,10,1][ck],cj=["0","0","F"][ck];for(var cg=ci,ch=ci+b6(ck);cg<ch;++cg){cf.push((cg<16?cj:"")+cg.toString(16).toUpperCase()+"00")}return cf.join("\\")}var cb=bc+"\\Cryptography\\CurrentVersion\\KeyCarriers\\",cc=["Rutoken","RutokenLite","ESMARTToken"][ce],cd=["Default","Default","64"][ce],ca=cb+cc+"\\"+cd+"\\",b9=bT;try{var b7=e(ce),b5="Folders";bG(aE,ca,b5,b7,false);if(b7!=bs(aE,ca,b5,false)){b9=2}}catch(b4){b9=1}return b9}function Q(){if(!ax()&&!ak()){return J}var cb="Policies\\",ca=bm+"Internet Explorer\\",b8=ca+"BrowserEmulation\\",b9=ca+"Main\\FeatureControl\\FEATURE_BROWSER_EMULATION\\",b5="iexplore.exe",cc=cb+b8+"PolicyList\\",cd=cb+b8+"QuirksPolicyList\\",b7="AllSitesCompatibilityMode",e=new RegExp("(a\\-practic|infotrust|kontur\\-ca|kontur\\-pf|skbkontur)\\.ru$","i"),b6=new RegExp("(atlasnw|dtcom|(^|\\.)kontur|kontur\\-extern|pascal)\\.ru$","i");function ce(cl,ck,cf){try{var cn=bi(cl,ck,cf);if(cn&&cn.length){for(var ci=0,cj=cn.length;ci<cj;++ci){var cm=cn[ci];if(cm&&(e.test(cm)||b6.test(cm))){try{bg(cl,ck,cm,cf)}catch(ch){}}}}}catch(cg){}}try{bE(aD,bw+b8,b7,0,false)}catch(b4){}try{bg(aD,bw+b9,b5,false)}catch(b4){}try{bE(aD,bw+cb+b8,b7,0,false)}catch(b4){}ce(aD,bw+cc,false);ce(aD,bw+cd,false);if(aK){try{bg(aE,bx+b9,b5,false)}catch(b4){}try{bE(aE,bx+cb+b8,b7,0,false)}catch(b4){}ce(aE,bx+cc,false);ce(aE,bx+cd,false)}try{bg(aE,bw+b9,b5,aK)}catch(b4){}try{bE(aE,bw+cb+b8,b7,0,aK)}catch(b4){}ce(aE,bw+cc,aK);ce(aE,bw+cd,aK);return bT}function bW(b6,b5,b4,b7,b8){try{bE(b6,b5,b4,b7,b8);return 0}catch(e){return e?e.number:1}}function X(){if(!ax()&&!ak()){return J}return bW(aE,be+"Policies\\Ratings\\.Default\\","Enabled",0,aK)}function S(){if(!ax()&&!ak()){return J}return bW(aE,bd+"\\KeyDevices\\","LicErrorLevel",6,false)}function V(b9){if(!ax()&&!ak()){return J}var e="warning_time_gen_2001",b4="warning_time_sign_2001",b5=1.31775552003391e+17;function b8(ce,cd){try{bg(ce,cd,e,false)}catch(cc){}try{bg(ce,cd,b4,false)}catch(cc){}}function cb(){try{bF(aE,bb,e,b5,false);bF(aE,bb,b4,b5,false);return 0}catch(cc){return aG("parameters.reg",false)}}var b7=cb();if(0===b7){var ca="VirtualStore\\MACHINE\\"+(aK?bb.replace(bw,bx):bb),b6=bd+"\\Users\\"+b9+"\\KeyDevices\\";b8(aE,b6);b8(aC,ca)}return b7}function E(){if(!ax()&&!ak()){return J}return bW(aE,bb,"tls_client_disable_legacy_cipher_suites",0,false)}function Z(){if(!ax()&&!ak()){return J}try{bE(aE,be+"Policies\\System\\","EnableLUA",0,aK);bE(aE,be+"Policies\\System\\","ConsentPromptBehaviorAdmin",0,aK);WScript.Echo("UAC \u043F\u043E\u043B\u043D\u043E\u0441\u0442\u044C\u044E \u043E\u0442\u043A\u043B\u044E\u0447\u0435\u043D.\n\u0414\u043B\u044F \u0432\u0441\u0442\u0443\u043F\u043B\u0435\u043D\u0438\u044F \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0439 \u0432 \u0441\u0438\u043B\u0443, \u043F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u043A\u043E\u043C\u043F\u044C\u044E\u0442\u0435\u0440.");return 0}catch(e){WScript.Echo("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043F\u043E\u043B\u043D\u043E\u0441\u0442\u044C\u044E \u043E\u0442\u043A\u043B\u044E\u0447\u0438\u0442\u044C UAC.\n\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0441\u0434\u0435\u043B\u0430\u0442\u044C \u044D\u0442\u043E \u0432\u0440\u0443\u0447\u043D\u0443\u044E.");return e?e.number:1}}function bL(){if(!ax()&&!ak()){return J}if(!ai()&&!ak()){return H}var b6="CRYPTO PRO\\SHARED\\PKIMGMT.RU.MSC";try{var b5=m(al().$System32,"mmc.exe"),e=m(al().$ComPFiles,b6);if(!ag(e).exist){e=m(al().$ComPFiles86,b6)}if(ag(b5).exist&&ag(e).exist){bJ(b5,'"'+e+'"',0,1);return bT}return 1}catch(b4){return 2}}function v(cd){if(!ax()&&!ak()){return J}var ca=be+"Run\\",cb=be+"RunOnce\\",ce=null,e=null;function b4(ck,cj,ch){if(ch&&(ch instanceof Array)&&ch.length){try{aM(ch)}catch(ci){}}if(ck&16){bg(aE,ba+"Session Manager\\AppCertDlls\\",cj.slice(-3),false)}else{if(ck&1){bg((ck&2)?aE:aD,(ck&4)?cb:ca,cj,!!(ck&8))}else{if(ck&2){e=e||au(true,!(ck&8));ag(e+cj).remove()}else{ce=ce||au(false,!(ck&8));ag(ce+cj).remove()}}}}cd=cd?cd.replace(new RegExp('^\\"+|\\"+$',"g"),""):"";var cc=cd?cd.split(new RegExp("\\/\\@\\#\\$\\/","g")):[],b6=0;for(var cf=0,cg=cc.length;cf<cg;++cf){var b7=cc[cf],b8=b7?b7.split(new RegExp(",","g")):[];if(b8.length>=2){try{var b9=b8.length>2?b8[2].split(new RegExp(":","g")):null;b4(Number(b8[0]),b8[1],b9)}catch(b5){if(!b5||2!=b5.number){b6=10}}}}return b6}function w(b7){if(!ax()&&!ak()){return J}b7=b7?b7.replace(new RegExp('^\\"+|\\"+$',"g"),""):"";var b6=b7?b7.split(new RegExp("\\/\\@\\#\\$\\/","g")):[],b5=m(al().$System32,"schtasks.exe"),b4=0;for(var b9=0,b8=b6.length;b9<b8;++b9){bJ(b5,'/End /TN "'+b6[b9]+'"',1);bJ(b5,'/Change /TN "'+b6[b9]+'" /DISABLE',1);var e=bJ(b5,'/Delete /TN "'+b6[b9]+'" /F',1);if(0!==e){b4=e}}return b4}function bN(){if(!ax()&&!ak()){return J}var b5="SiteList",b7="https://help.kontur.ru/EMSiteList.xml",b6=bw+"Policies\\"+bm+"Internet Explorer\\Main\\EnterpriseMode\\",e=0;function b8(cd,cc,cf,ce,cb){try{if(ce!=bs(cd,cc,cf,cb)){throw new Error()}}catch(b9){try{bG(cd,cc,cf,ce,cb)}catch(ca){return ca?ca.number:1}}return 0}try{if(aK){e+=(b8(aE,b6,b5,b7,false)&65535)}e+=(b8(aE,b6,b5,b7,aK)&65535)<<8}catch(b4){e+=(1<<8)}try{e+=(b8(aD,b6,b5,b7,false)&65535)<<16}catch(b4){e+=(1<<16)}return e}function bu(){return parseFloat(bs(aE,bz,u,false))}function bt(){return parseFloat(bs(aE,bz,"CurrentBuild",false))}function b1(cg,cc,b6){if(!ax()&&!ak()){return J}var ch=new RegExp("/@#$/","g"),cf=cg?cg.split(ch):[],cb=cc?cc.split(ch):[],b5=b6?b6.split(ch):[],ce=cf.length;if(ce!=cb.length){return 10}var b9=0;function ca(ci,e,cj){if(e){bG(aE,a9,ci,e,cj)}else{bg(aE,a9,ci,cj)}}for(var cd=0;cd<ce;++cd){try{var b4=aK?Number(b5[cd]):0;try{ca(cf[cd],cb[cd],b4)}catch(b8){if(!aK){throw b8}ca(cf[cd],cb[cd],!b4)}}catch(b7){b9=11+cd}}return b9}function A(cd,b6){if(!ax()&&!ak()){return J}var ce=new RegExp("/@#$/","g"),cb=cd?cd.split(ce):[],cc=cb.length,b5=b6?b6.split(ce):[],b8=0;if(cc!=b5.length){return 10}for(var b9=0,ca=cc;b9<ca;++b9){try{var b4=Number(b5[b9]);bf(b4?aE:aD,cb[b9],aK?(b4==2):false)}catch(b7){b8=11+b9}}return b8}function bU(b5){if(!ax()&&!ak()){return J}if(!b5||!b5.length){return 4}try{bg(aE,bv+b5+"\\","WOW64",false);return 0}catch(b4){return b4?b4.number:1}}function L(){if(!ax()&&!ak()){return J}try{bE(aE,bw+"Policies\\Adobe\\Acrobat Reader\\DC\\FeatureLockDown\\","bUsageMeasurement",0,aK);return 0}catch(e){return e?e.number:1}}function bV(b6,b4,b7){try{bf(b6,b4,b7)}catch(b5){var e=b5.number||b5.code;if(2!==e){throw b5}}}function ab(){if(!ax()&&!ak()){return J}try{bE(aE,ba+"Session Manager\\CProPatches\\","Force",1,false)}catch(b7){}try{var b4=bl+"Cryptography\\OID\\EncodingType 1\\CryptMsgDllImportKeyTrans\\1.2.643.2.2.19\\";bV(aE,b4,false);if(aK){bV(aE,b4,true)}}catch(e){return e?e.number:1}try{var b6=bR("CryptSvc","restart");if(0!==b6){return b6}}catch(b5){return 2}return 0}function q(){if(!ax()&&!ak()){return J}try{var b4=bl+"Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.2.643.2.1.3.2.1!1";bV(aE,b4,false);if(aK){bV(aE,b4,true)}}catch(e){return e?e.number:1}try{var b6=bR("CryptSvc","restart");if(0!==b6){return b6}}catch(b5){return 2}return 0}var ad=983103,aY=131072,aX=131097,aU=1;function ay(ci,cj,cr,cs){var cf=null,ce=null,ch,b4={},ck=ao();try{ch=av(ck.getSecurity(aE,ci,cs));for(var b6=0,b7=ch.length;b6<b7;++b6){var b8=ch[b6];b4[b8.sid]=b8.allow&~b8.deny}}catch(b5){}for(var co in cj){try{ck.setSecurity(aE,ci,co,cj[co]|(b4[co]||0),cs)}catch(cn){cf=cn}}try{ck.setOwner(aE,ci,"S-1-5-32-544",cs)}catch(cm){ce=cm}if(cf&&!ce){cf=null;for(var cp in cj){try{ck.setSecurity(aE,ci,cp,cj[cp]|(b4[cp]||0),cs)}catch(cn){cf=cn}}}try{ch=av(ck.getSecurity(aE,ci,cs));for(var cc=0,cd=ch.length;cc<cd;++cc){var b9=ch[cc];if(b9.deny){try{var cg=aY|b9.allow;ck.setSecurity(aE,ci,b9.sid,cg,cs);b4[b9.sid]=cg}catch(cl){}}}}catch(b5){var e=["S-1-5-32-545","S-1-1-0","S-1-5-32-544","S-1-5-32-545"];if(cr){e.push(cr)}cf=null;for(var ca=0,cb=e.length;ca<cb;++ca){var cq=e[ca];try{ck.setSecurity(aE,ci,cq,aY|(b4[cq]||0)|(cj[cq]||0),cs)}catch(cn){cf=cn}}}if(cf){throw cf}}function x(b9){if(!b9||!b9.length){return 1}var b8=b9.split(new RegExp(";;;","g")),b4=0;for(var b5=0,b6=b8.length;b5<b6;++b5){var b7=b8[b5];try{bf(aE,a6+"\\"+b7,aK)}catch(e){if(!b4){b4=e&&e.number||1}}}return b4}function N(){try{var b7={"S-1-5-18":ad,"S-1-5-19":ad,"S-1-5-32-544":ad,"S-1-5-32-545":aX};try{ay(a5,b7,null,aK)}catch(b5){return 2}try{ay(a6,b7,null,aK)}catch(b6){if(!aJ(b6)){return 3}}return 0}catch(b4){return b4?b4.number:1}}function R(cj){function b5(cl,cm){var cn={};for(var e in cl){cn[e]=cl[e]}for(var ck in cm){cn[ck]=cm[ck]}return cn}try{var b7=bd+"\\Users",b6=b7+"\\"+cj,b4={"S-1-5-18":ad,"S-1-5-32-544":ad},cf=b5(b4,{"S-1-5-32-545":aX}),cc={"S-1-1-0":aU},cd={"S-1-1-0":aX},ci={"S-1-5-18":ad};cf[cj]=aX;ci[cj]=ad;var b9=[{path:bc,rights:cf},{path:bd,rights:b5(cf,cd)},{path:bd+"\\KeyDevices",rights:b5(b4,cc)},{path:bd+"\\Keys",rights:b4},{path:b7,rights:b5(b4,cd)},{path:b6,rights:ci},{path:b6+"\\KeyDevices",rights:ci},{path:b6+"\\Keys",rights:ci},{path:b6+"\\Random",rights:ci}];var cb=0;for(var cg=0,ch=b9.length;cg<ch;++cg){try{var b8=b9[cg];ay(b8.path,b8.rights,cj,false)}catch(ce){if(!aJ(ce)){cb=ce.number||3}}}return cb}catch(ca){return ca?ca.number:1}}function Y(b5){var b8=ba+"Class\\{50DD5230-BA8A-11D1-BF5D-0000F805F530}\\",b7="UpperFilters",b6=(b5&&"[]"!=b5)?b5.split(new RegExp(";","g")):[];try{if(b6.length){bD(aE,b8,b7,b6,false)}else{bg(aE,b8,b7,false)}return 0}catch(b4){return b4?b4.number:1}}function P(b4){var b8=ba+"CoDeviceInstallers\\",b7="{50DD5230-BA8A-11D1-BF5D-0000F805F530}",b5=(b4&&"[]"!=b4)?b4.split(new RegExp("\\{;;;\\}","g")):[];try{if(b5.length){bD(aE,b8,b7,b5,false)}else{bg(aE,b8,b7,false)}return 0}catch(b6){return b6?b6.number:1}}function bQ(b5){try{var b6=be+"AppModelUnlock\\";bE(aE,b6,"AllowAllTrustedApps",b5?0:1,aK);bE(aE,b6,"AllowDevelopmentWithoutDevLicense",b5?1:0,aK);return 0}catch(b4){return b4?b4.number:1}}function C(){return bQ(false)}function D(){return bQ(true)}function ak(b8){if(bX===c||b8){a=h=bX;var b7=[214,213,212,211,210,209,208,207,206,205,204,203,202,201,200];for(var b5=0,b6=b7.length;b5<b6;++b5){var e=Math.floor(b7[b5]/100)+"."+(b7[b5]%100);try{c=s(["Kontur","Diag",e]);if(c){break}}catch(b4){c=null}}}try{return(!c||c.hasAccess())?c:false}catch(b4){c=null;return false}}function W(){var b5="SYSTEM\\CurrentControlSet\\Control\\Nls\\";try{bG(aE,b5+"Language","Default","0419",false);bG(aE,b5+"Locale","(Default)","00000419",false);bG(aE,b5+"CodePage","ACP","1251",false)}catch(b4){return b4?b4.number:1}return bT}function b3(b4,e,b8){var b6=("agent"==e)?"agent.properties":"transport.properties",b7=m(b4,e+"\\conf\\"+b6);try{b0(b7,b8.join("\n")+"\n",false);return 0}catch(b5){return b5&&(b5.number&255)||1}}function aa(ck,b5,cm,cd,b6,ce,b7,cf,ch,ci,cg,cc,ca,cb){var b8=("rutoken"==ck),b9=al(),cj=aK?b9.$SysWOW64:b9.$System32,cl=0;b5=b5.replace(new RegExp("(/|\\\\)+","g"),"\\");ce=(ce||m(cj,b8?"rtPKCS11ECP-replica.dll":"asepkcs.dll")).replace(new RegExp("(/|\\\\)+","g"),"\\\\");b7=(b7||m(cj,b8?"rttranscrypt.dll":"libtranscrypt.dll")).replace(new RegExp("(/|\\\\)+","g"),"\\\\");cd=cd||(b8?"12345678":"11111111");b6=b6||(b8?"12345678":"0987654321");cm=cm||"8080";cf=cf||"";ch=ch||"";ci=ci||"";cg=cg||"";cc=(1==cc);ca=(1==ca);cb=(1==cb);cl|=b3(b5,"agent",["###############################################","# UTM server","###############################################","utm.port="+cm,"###############################################","# Updater server","###############################################","updater.connector=127.0.0.1:8193","###############################################","# PKI keystore passwords","###############################################","crypto.lib.pki.keystorePassword="+cd,"crypto.lib.gost.keystorePassword="+b6,"###############################################","# Path to rsa library","###############################################","rsa.library.path="+ce,"gost.library.path="+b7])<<24;cl|=b3(b5,"monitoring",(["###############################################","# Transport Monitoring","###############################################","monitoring.address=https://update.egais.ru/monitor/file","","# First start time (default = now)","# Date format: yyyy-MM-dd HH:mm:ss","timer.first.time=2014-06-12 14:16:00","# Delay between check in milliseconds (default 3600000 = one per hour)","timer.delay.ms=3600000","","# PKI keystore passwords","crypto.lib.pki.keystorePassword="+cd,"crypto.lib.pki.keyPassword=11111111","","# Saved reports quantity before sending to server","saved.reports.quantity=0","","# Proxy settings"]).concat((cf&&ch)?["proxy.host="+cf,"proxy.port="+ch,"proxy.user="+ci,"proxy.password="+cg]:["#proxy.host=10.0.50.187","#proxy.port=3128"]).concat(["","###############################################","# Path to rsa library","###############################################","rsa.library.path="+ce]))<<16;cl|=b3(b5,"transporter",["###############################################","# Web server","###############################################","web.server.port="+cm,"###############################################","# GOST keystore passwords","###############################################","crypto.lib.gost.keystorePassword="+b6,"crypto.lib.gost.keyPassword=0987654321","###############################################","# PKI keystore passwords","###############################################","crypto.lib.pki.keystorePassword="+cd,"crypto.lib.pki.keyPassword=11111111","###############################################","# Proxy","###############################################","proxy.host="+cf,"proxy.port="+ch,"proxy.user="+ci,"proxy.password="+cg,"###############################################","# Cross-origin resource sharing","###############################################","access.control.allow.origin=","###############################################","# Ports for service negotiations","###############################################","transport.service.port=8192","updater.connector=127.0.0.1:8193","agent.connector.port=127.0.0.1:8194","###############################################","# Path to libraries","###############################################","rsa.library.path="+ce,"gost.library.path="+b7])<<8;cl|=b3(b5,"updater",["###############################################","# Transport config","###############################################","transport.client.id=777","transport.app.home=../../transporter","crypto.lib.pki.keystorePassword="+cd,"crypto.lib.gost.keystorePassword="+b6,"#crypto.lib.pki.keyPassword=11111111","#crypto.lib.pki.keyAlias","###############################################","# Update address","###############################################","update.address=https://update.egais.ru/update","update.properties.address=https://update.egais.ru/properties","# First start time (default = now)","# Date format: yyyy-MM-dd HH:mm:ss","timer.first.time=2014-06-12 14:16:00","# Delay between check in milliseconds (default 3600000 = one per hour)","timer.delay.ms=86400000","###############################################","# Proxy","###############################################","proxy.host="+cf,"proxy.port="+ch,"proxy.user="+ci,"proxy.password="+cg,"###############################################","# Ports for service negotiations","###############################################","updater.service.port=8193","transport.connector=127.0.0.1:8192","agent.connector.port=127.0.0.1:8194","###############################################","# Path to rsa library","###############################################","rsa.library.path="+ce]);function b4(cp){var cn=m(b5,cp+"\\bin"),co=m(cn,"InstallDaemon.bat");return bJ(m(cj,"cmd.exe"),'/C "'+co+'"',1,0,cn)}function e(cs,cn,cq,cr){var co;try{if(cq){b4(cn)}co=bR(cs,"restart")}catch(cp){co=(cp?cp.number:2)}return(co&255)<<cr}if(!cl){cl|=e("Transport-Updater","updater",cc,0);cl|=e("Transport","transporter",cb,8);cl|=e("Transport-Monitoring","monitoring",ca,16)}return cl}function aV(e){WScript.Quit(e)}var l=WScript?WScript.Arguments:null,aN=l?l.length:0,bI=bX,bY=bX,p=I,G=bX;if(aN>0){bI=l(aN-1);if(aN>1){bY=l(aN-2)}try{var aA={DisableAddons:[z,1],FixBadUserAgent:[M,0],InstallFixer:[aH,3],RunAsAdmin:[bK,2],CreateService:[t,2],CreateAndStartService:[r,2],StartService:[bR,2],StopService:[bS,1],FixRegFirebird:[o,2],SetCSPLicense:[bM,3],SetOffSigLicense:[bP,3],SvcRemoveWow64:[bU,1],FixCSPRandom:[T,0],FixCSPReaders:[U,0],FixCarrierToken:[O,2],FixCryptoProRegSettings:[R,1],FixCompatMode:[Q,0],FixParentalControl:[X,0],FixUac:[Z,0],FixCspLicErrorLevel:[S,0],FixNewGostDate:[V,1],RunCSPLicensePKI:[bL,0],SetEnterpriseMode:[bN,0],DeleteBadAutorun:[v,1],DeleteBadTasks:[w,1],WriteCompatFlags:[b1,3],DisablePlugins:[A,2],FixAdobeReaderDC:[L,0],FixVipNetCSPConflict:[ab,0],ContinentApConflict:[q,0],DeleteCalaisReaders:[x,1],FixCalaisReadersRights:[N,0],EnableAllTrustedMode:[C,0],EnableDevMode:[D,0],FixScfilter:[Y,1],FixCoDeviceInstallers:[P,1],EnableLegacyCipherSuites:[E,0],FixNonUnicodeProgramsLanguage:[W,0],FixUTMConfigs:[aa,14]};var az=aA[l(0)],aP=az[1];if(az&&(aN>aP)){var ac=[];for(var aL=1;aL<=aP;++aL){ac.push(l(aL))}p=az[0].apply(null,ac)}else{p=123}}catch(B){G="Unknown error";if(B){G=(B.description||B.message||B);if(B.number){var aQ=B.number,aB=aQ;if(aB<0){aB=4294967295+aQ+1}G+=" ("+aQ+", 0x"+aB.toString(16).toUpperCase()+")"}}p=255}if((0!==p)&&bI&&bI.length){b2(bI,p,G)}}aV(p)})();

## pretty prints to:

(function(bX) {
    var i = bX,
        k = bX,
        b = bX,
        d = bX,
        f = bX,
        g = bX,
        aR = bX,
        j = bX,
        c = bX,
        a = bX,
        h = bX,
        aK = aI(),
        aO = "winmgmts:",
        aF = "{impersonationLevel=impersonate}",
        aC = 2147483648,
        aD = 2147483649,
        aE = 2147483650,
        bj = "HKCU\\",
        bk = "HKLM\\",
        bw = "Software\\",
        bx = bw + "Wow6432Node\\",
        bm = "Microsoft\\",
        bl = bw + bm,
        u = "CurrentVersion",
        a5 = bl + "Cryptography\\Calais",
        a6 = a5 + "\\Readers",
        be = bl + "Windows\\" + u + "\\",
        bz = bl + "Windows NT\\" + u + "\\",
        a8 = bz + "AppCompatFlags\\",
        a9 = a8 + "Layers\\",
        by = "SYSTEM\\CurrentControlSet\\",
        ba = by + "Control\\",
        bv = by + "Services\\",
        bc = bw + "Crypto Pro",
        bb = bc + "\\Cryptography\\" + u + "\\Parameters\\",
        bd = bc + "\\Settings",
        aZ = "REG_BINARY",
        a0 = "REG_DWORD",
        a1 = "REG_EXPAND_SZ",
        a2 = "REG_MULTI_SZ",
        a3 = "REG_QWORD",
        a4 = "REG_SZ",
        bT = 0,
        H = 252,
        J = 253,
        I = 254;

    function F(b5, e, b4) {
        this.description = b5;
        this.message = b5;
        this.code = e;
        this.number = e;
        this.innerError = b4
    }
    F.prototype = {
        prototype: Error.prototype,
        constructor: F,
        name: "NumberedError"
    };

    function av(e) {
        return (e !== null) ? new VBArray(e).toArray() : null
    }

    function aq(e) {
        return (aE == e) ? bk : bj
    }
    var aS = new RegExp("^(\\\\)+"),
        aT = new RegExp("(\\\\)+$");

    function m(e, b4) {
        if (!e || !b4) {
            return ""
        }
        return e.replace(aT, "") + "\\" + b4.replace(aS, "")
    }

    function s(e) {
        return (new Function(["return new ", "Activ", 'eXObject("'].join("") + e.join(".") + '")'))()
    }

    function at() {
        if (i === bX) {
            try {
                i = s(["Shell", "Application"])
            } catch (e) {
                i = null
            }
        }
        return i
    }

    function ax() {
        if (k === bX) {
            try {
                k = s(["WScript", "Shell"])
            } catch (e) {
                k = null
            }
        }
        return k
    }

    function ai() {
        if (b === bX) {
            try {
                b = s(["Scripting", "FileSystemObject"])
            } catch (e) {
                b = null
            }
        }
        return b
    }

    function am(b6) {
        if (b6 || f === bX) {
            var cd = "StdRegProv",
                e = function(cf) {
                    cf.CheckAccess(aD, "Software")
                };
            try {
                var ce = s(["WbemScripting", "SWbemLocator"]),
                    cc = ce.ConnectServer("", "root\\default", "", "", "MS_0419");
                cc.Security_.ImpersonationLevel = 3;
                f = cc.Get(cd)
            } catch (b4) {
                var b9 = ["//./root/default:", cd].join(""),
                    ca = ["\\\\.\\root\\default:", cd].join(""),
                    b8 = [aO + aF + b9, aO + aF + ca, aO + aF + "!" + b9, aO + aF + "!" + ca, aO + b9, aO + ca, aO + "!" + b9, aO + "!" + ca];
                for (var b7 = 0, cb = b8.length; b7 < cb; ++b7) {
                    try {
                        f = GetObject(b8[b7]);
                        e(f);
                        break
                    } catch (b5) {
                        f = null
                    }
                }
            }
        }
        return f
    }

    function an(b4) {
        if (b4 || g === bX) {
            try {
                aR = s(["WbemScripting", "SWbemNamedValueSet"]);
                aR.Add("__ProviderArchitecture", 64);
                var b5 = s(["WbemScripting", "SWbemLocator"]),
                    b6 = b5.ConnectServer("", "root\\default", "", "", "MS_0419", null, null, aR);
                b6.Security_.ImpersonationLevel = 3;
                g = b6.Get("StdRegProv")
            } catch (e) {
                g = null;
                aR = null
            }
        }
        return g
    }

    function aw() {
        if (j === bX) {
            var e = function(cd) {
                var cc = ["SELECT * FROM Win32_Opera", "tingSystem"].join(""),
                    ce = cd.ExecQuery(cc, "WQL", 48);
                return new Enumerator(ce)
            };
            try {
                var b7 = s(["WbemScripting", "SWbemLocator"]);
                j = b7.ConnectServer("", "root\\cimv2", "", "", "MS_0419");
                j.Security_.ImpersonationLevel = 3
            } catch (b4) {
                var ca = "//./root/cimv2",
                    cb = "\\\\.\\root\\cimv2",
                    b9 = [aO + aF + ca, aO + aF + cb, aO + aF + "!" + ca, aO + aF + "!" + cb, aO + ca, aO + cb, aO + "!" + ca, aO + "!" + cb];
                for (var b6 = 0, b8 = b9.length; b6 < b8; ++b6) {
                    try {
                        j = GetObject(b9[b6]);
                        e(j);
                        break
                    } catch (b5) {
                        j = null
                    }
                }
            }
        }
        return j
    }

    function ae() {
        try {
            return s(["ADODB", "Stream"])
        } catch (e) {
            return null
        }
    }

    function bZ(b7, b6, e) {
        var b4 = [];
        for (var b5 = 0; b5 < e; ++b5) {
            b4.push("arguments[" + b5 + "]")
        }
        return new Function("o", "return function(){ return o." + b6 + "(" + b4.join(",") + ");}")(b7)
    }

    function ao() {
        var e = ak();
        return e && e.registryWorker
    }

    function K(b4) {
        try {
            return ax().ExpandEnvironmentStrings(b4)
        } catch (e) {
            return ak().environmentWorker.expandVariable(b4)
        }
    }

    function al(e) {
        if ((e || d === bX) && (ak() || ax())) {
            var b6 = {
                "$AllUsers": ["%ALLUSE", "RSPROFILE%"],
                "$AppData": ["%APP", "DATA%"],
                "$Arch": ["%PROCESSOR_", "ARCHITECTURE%"],
                "$Cmd": ["%Com", "Spec%"],
                "$ComPFiles": ["%Common", "Program", "Files%"],
                "$ComPFiles86": ["%Common", "Program", "Files(x86)%"],
                "$CompName": ["%Computer", "Name%"],
                "$PFiles": ["%Program", "Files%"],
                "$PFiles86": ["%Program", "Files(x86)%"],
                "$PFiles64": ["%Program", "W6432%"],
                "$SystemDrive": ["%System", "Drive%"],
                "$Temp": ["%TE", "MP%"],
                "$UserDNSDomain": ["%USERDNS", "DOMAIN%"],
                "$UserDomain": ["%USER", "DOMAIN%"],
                "$UserName": ["%USER", "NAME%"],
                "$UserProfile": ["%USER", "PROFILE%"],
                "$Windows": ["%System", "Root%"]
            };
            d = {};
            for (var b5 in b6) {
                d[b5] = K(b6[b5].join(""))
            }
            var b7 = d.$Windows,
                b4 = ["Internet ", "Explorer"].join("");
            d["$IE"] = m(d.$PFiles, b4);
            d["$IE86"] = m(d.$PFiles86, b4);
            d["$SysNative"] = m(b7, ["Sys", "Native"].join(""));
            d["$System32"] = m(b7, ["Sys", "tem32"].join(""));
            d["$SysWOW64"] = m(b7, ["Sys", "WOW64"].join(""));
            d["$SysTemp"] = m(b7, ["Te", "mp"].join(""))
        }
        return d
    }

    function ag(b8) {
        if (!b8) {
            return {}
        }
        var cd = b8.lastIndexOf("\\"),
            cc = b8.substr(cd + 1),
            b9 = (cd > 0) ? b8.substr(0, cd + 1) : "",
            e = cc.lastIndexOf("."),
            b6 = (e > 0) ? cc.substr(e + 1).toLowerCase() : "",
            b7 = {
                ext: b6,
                exist: false,
                folder: b9
            };
        try {
            var ca = ai();
            if (!ca) {
                throw new Error()
            }
            if (ca.FileExists(b8)) {
                b7.exist = true;
                try {
                    b7.size = b.GetFile(b8).Size
                } catch (b5) {}
            }
            b7.copy = function(ce) {
                if (ca.FileExists(ce)) {
                    ca.DeleteFile(ce, true)
                }
                ca.CopyFile(b8, ce, true);
                return this
            };
            b7.remove = function() {
                if (ca.FileExists(b8)) {
                    ca.DeleteFile(b8, true);
                    this.exist = false
                }
                return this
            };
            return b7
        } catch (b4) {}
        var cb = ak();
        if (cb) {
            if (cb.isFileExist(b8)) {
                b7.exist = true;
                try {
                    b7.size = c.getFileObject(b8).size
                } catch (b4) {}
            }
            b7.copy = function(ce) {
                if (cb.isFileExist(ce)) {
                    cb.deleteFile(ce)
                }
                cb.getFileObject(b8).copyTo(ce);
                return this
            };
            b7.remove = function() {
                if (cb.isFileExist(b8)) {
                    cb.deleteFile(b8);
                    this.exist = false
                }
                return this
            }
        }
        return b7
    }

    function ah(b6) {
        if (!b6) {
            return {}
        }
        if (b6.charAt(b6.length - 1) == "\\") {
            b6 = b6.substr(0, b6.length - 1)
        }
        var ca = b6.lastIndexOf("\\"),
            b9 = ~ca ? b6.substr(0, ca + 1) : "";
        var b5 = {
            exist: false,
            parent: b9
        };
        try {
            var b7 = ai();
            if (!b7) {
                throw new Error()
            }
            b5.exist = b7.FolderExists(b6);
            b5.create = function() {
                if (!b7.FolderExists(b6)) {
                    b7.CreateFolder(b6);
                    this.exist = true
                }
                return this
            };
            b5.remove = function() {
                if (b7.FolderExists(b6)) {
                    b7.DeleteFolder(b6, true);
                    this.exist = false
                }
                return this
            };
            return b5
        } catch (b4) {}
        var b8 = ak(),
            e = b8 && b8.directoryWorker;
        if (e) {
            b5.exist = e.isExist(b6);
            b5.create = function() {
                if (!e.isExist(b6)) {
                    e.create(b6);
                    this.exist = true
                }
                return this
            };
            b5.remove = function() {
                if (e.isExist(b6)) {
                    e.remove(b6);
                    this.exist = false
                }
                return this
            }
        }
        return b5
    }

    function aj() {
        return WScript.ScriptFullName
    }

    function af() {
        return ag(aj()).folder
    }

    function b0(b8, b4, b9) {
        try {
            ak().getTextFileObject(b8).write(b4, b9 ? 1200 : 1251)
        } catch (b5) {
            var ca = ae();
            if (ca) {
                ca.Mode = 3;
                ca.Type = 2;
                ca.Open();
                ca.Charset = b9 ? "utf-16" : "windows-1251";
                ca.WriteText(b4);
                if (b9) {
                    ca.Position = 2;
                    var e = ae();
                    e.Mode = 3;
                    e.Type = 1;
                    e.Open();
                    ca.CopyTo(e);
                    ca.Flush();
                    try {
                        ca.Close()
                    } catch (b6) {}
                    e.SaveToFile(b8, 2);
                    e.Flush();
                    try {
                        e.Close()
                    } catch (b6) {}
                } else {
                    ca.SaveToFile(b8, 2);
                    try {
                        ca.Close()
                    } catch (b6) {}
                }
            } else {
                if (ai()) {
                    var b7 = ai().OpenTextFile(b8, 2, true, b9 ? -1 : 0);
                    b7.Write(b4);
                    b7.Close()
                } else {
                    throw b5
                }
            }
        }
    }

    function aW(b7) {
        try {
            return ak().getTextFileObject(b7).readAll(1200)
        } catch (b4) {
            var b8 = ae();
            if (b8) {
                b8.Type = 2;
                b8.Charset = "Unicode";
                b8.Open();
                b8.LoadFromFile(b7);
                var e = b8.ReadText(-1);
                try {
                    b8.Close()
                } catch (b5) {}
                return e
            } else {
                if (ai()) {
                    var b6 = ai().OpenTextFile(b7, 1, false, -1),
                        b9 = b6.ReadAll();
                    b6.Close();
                    return b9
                } else {
                    throw b4
                }
            }
        }
    }

    function bJ(b9, e, cd, cb, b4) {
        e = e ? (" " + e) : "";
        var b8 = null;
        try {
            var ce = ax();
            if (b4) {
                b8 = ce.CurrentDirectory;
                ce.CurrentDirectory = b4
            }
            var ca = ce.Run('"' + b9 + '"' + e, cb ? 1 : 0, cd ? 1 : 0);
            if (b8) {
                try {
                    ce.CurrentDirectory = b8
                } catch (b6) {}
            }
            return ca
        } catch (b5) {
            try {
                var b7 = ak(),
                    cc = b7.startProcess(b9, e, b4 || "", !!cb, !!cd, true, false);
                return cc.exitCode
            } catch (b6) {
                return -1
            }
        }
    }

    function au(e, b6) {
        var b8;
        try {
            try {
                b8 = ax().SpecialFolders((e ? "AllUsers" : "") + "Startup");
                if (!ah(b8).exist) {
                    throw F("Folder not found: " + b8, 2)
                }
            } catch (b5) {
                b8 = ak().getShellFolder(e ? 24 : 7);
                if (!ah(b8).exist) {
                    throw F("Folder not found: " + b8, 2)
                }
            }
        } catch (b4) {
            var b7 = al()[e ? "$AllUsers" : (b6 ? "$UserProfile" : "$AppData")];
            b7 += b6 ? "" : "Microsoft\\Windows\\";
            b8 = m(b7, "Start Menu\\Programs\\Startup\\");
            if (!ah(b8).exist) {
                b8 = m(b7, "\u0413\u043B\u0430\u0432\u043D\u043E\u0435 \u041C\u0435\u043D\u044E\\\u041F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u044B\\\u0410\u0432\u0442\u043E\u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0430\\");
                if (!ah(b8).exist) {
                    return null
                }
            }
        }
        return b8
    }

    function b2(b4, b5, b6) {
        if (!ag(b4).exist) {
            try {
                var b7 = b5;
                if (b6) {
                    b7 += "\r\n" + b6
                } else {
                    if (b5 == J) {
                        b7 += "\r\nCould not create WS"
                    }
                }
                b0(b4, b7)
            } catch (e) {}
        }
    }

    function aM(e) {
        if (e instanceof Array) {
            e = e.join(" /PID ")
        }
        var b4 = m(al().$System32, "taskkill.exe");
        return bJ(b4, "/PID " + e + " /T /F", 1)
    }

    function aI() {
        try {
            var e = (K("%PROCESSOR_ARCHITECTURE%") || "").toUpperCase();
            if ("AMD64" == e) {
                return true
            }
            var b4 = (K("%PROCESSOR_ARCHITEW6432%") || "").toUpperCase();
            if ("AMD64" == b4) {
                return true
            }
            throw new Error()
        } catch (b5) {
            return ah(al().$SysWOW64).exist
        }
    }

    function ap(b4, e, b5) {
        return aq(b4) + (e || "").replace(aT, "") + "\\" + (b5 || "")
    }

    function n(b5, e, cc, cb, ce) {
        var b9 = ce ? an() : am(),
            b7 = b9.Methods_.Item(b5).InParameters.SpawnInstance_(),
            b8;
        b7.hDefKey = e;
        b7.sSubKeyName = cc;
        if (cb) {
            b7.sValueName = cb
        }
        try {
            if (ce && aR) {
                b8 = b9.ExecMethod_(b5, b7, null, aR)
            } else {
                b8 = b9.ExecMethod_(b5, b7)
            }
        } catch (b4) {
            return cb ? null : []
        }
        var ca = b8.ReturnValue;
        if (ca && (-1 != ca)) {
            var b6 = "Error call " + (ce ? "x64:" : "x32:") + b5;
            throw new F(b6 + " (" + ap(e, cc, cb) + ") - error code " + ca, ca)
        }

        function cd(ch) {
            try {
                var cf = ch.toArray();
                return cf || []
            } catch (cg) {
                return []
            }
        }
        if (cb) {
            if ("GetMultiStringValue" === b5) {
                return cd(b8.sValue)
            }
            if ("GetStringValue" === b5 || "GetExpandedStringValue" === b5) {
                return b8.sValue
            }
            return b8.uValue
        }
        return cd(b8.sNames)
    }

    function aJ(e) {
        return e && (e.number === -2147024894 || e.number === 2147942402 || e.number === 2)
    }

    function a7(e, b4) {
        if (b4 || (e && ~e.indexOf("\\"))) {
            throw F("isX64 or Value has \\", 1)
        }
    }

    function bo(b4, b6, b5, b7) {
        try {
            a7(b7);
            return ax().RegRead(ap(b6, b5, b7))
        } catch (e) {
            if (e && (!e.number || aJ(e))) {
                throw e
            }
            return n(b4, b6, b5, b7, false)
        }
    }

    function bp(e, b5, b4, b6) {
        return n(e, b5, b4, b6, true)
    }

    function bn(e, b5, b4, b6, b7) {
        return (b7 ? bp : bo)(e, b5, b4, b6)
    }

    function br(b5, b4, b6, b7) {
        try {
            return ao().getDwordValue(b5, b4, b6, !!b7)
        } catch (e) {
            return bn("GetDWORDValue", b5, b4, b6, b7)
        }
    }

    function bs(b6, b5, b7, b8) {
        try {
            a7(b7, b8);
            return ax().RegRead(ap(b6, b5, b7))
        } catch (e) {
            try {
                return ao().getStrValue(b6, b5, b7, !!b8)
            } catch (b4) {
                return n("GetStringValue", b6, b5, b7, b8)
            }
        }
    }

    function bq(b6, b5, b7, b8) {
        try {
            return av(ao().getMultiStrValue(b6, b5, b7, !!b8))
        } catch (b4) {
            return bn("GetMultiStringValue", b6, b5, b7, b8)
        }
    }

    function bA(cc, b9, ce, cd, cg) {
        try {
            ao().setBinValue(cc, b9, ce, cd, !!cg)
        } catch (e) {
            try {
                var b8 = ap(cc, b9, ""),
                    cf = ax();
                try {
                    cf.RegRead(b8)
                } catch (b4) {
                    try {
                        cf.RegWrite(b8, "", a4)
                    } catch (b5) {}
                }
                cf.RegWrite(ap(cc, b9, ce), cd, aZ)
            } catch (b6) {
                var ca = cg ? an() : am();
                try {
                    ca.CreateKey(cc, b9)
                } catch (b7) {}
                var cb = ca.SetBinaryValue(cc, b9, ce, cd);
                if (cb !== 0) {
                    throw new F("SetBinaryValue", cb, b6)
                }
            }
        }
    }

    function bE(cc, b9, ce, cd, cg) {
        try {
            ao().setDwordValue(cc, b9, ce, cd, !!cg)
        } catch (e) {
            try {
                a7(ce, cg);
                var b8 = ap(cc, b9, ""),
                    cf = ax();
                try {
                    cf.RegRead(b8)
                } catch (b5) {
                    try {
                        cf.RegWrite(b8, "", a4)
                    } catch (b6) {}
                }
                cf.RegWrite(ap(cc, b9, ce), cd, a0)
            } catch (b4) {
                var ca = cg ? an() : am();
                try {
                    ca.CreateKey(cc, b9)
                } catch (b7) {}
                var cb = ca.SetDWORDValue(cc, b9, ce, cd);
                if (cb !== 0) {
                    throw new F("regWriteNumber", cb, b4)
                }
            }
        }
    }

    function bG(cc, b9, ce, cd, cg) {
        try {
            ao().setStrValue(cc, b9, ce, cd, !!cg)
        } catch (e) {
            try {
                a7(ce, cg);
                var b8 = ap(cc, b9, ""),
                    cf = ax();
                try {
                    cf.RegRead(b8)
                } catch (b5) {
                    try {
                        cf.RegWrite(b8, "", a4)
                    } catch (b6) {}
                }
                cf.RegWrite(ap(cc, b9, ce), cd, a4)
            } catch (b4) {
                var ca = cg ? an() : am();
                try {
                    ca.CreateKey(cc, b9)
                } catch (b7) {}
                var cb = ca.SetStringValue(cc, b9, ce, cd);
                if (cb !== 0) {
                    throw new F("regWriteString", cb, b4)
                }
            }
        }
    }

    function bB(ca, b6, cc, cb, b9, b5) {
        var b7 = m(al().$System32, "reg.exe"),
            b8 = ap(ca, b6, "").replace(aT, ""),
            e = 'add "' + b8 + '" /v "' + cc + '" /t ' + b9 + " /d " + cb + " /f",
            b4 = bJ(b7, e, 1);
        if (0 !== b4) {
            throw new F("regWriteCmd", b4, b5)
        }
    }

    function bD(b9, b6, cb, ca, cc) {
        try {
            ao().setMultiStrValue(b9, b6, cb, ca, !!cc)
        } catch (e) {
            try {
                var b7 = cc ? an() : am();
                try {
                    b7.CreateKey(b9, b6)
                } catch (b5) {}
                var b8 = b7.SetMultiStringValue(b9, b6, cb, ca);
                if (b8 !== 0) {
                    throw new F("regWriteMultiString", b8, e)
                }
            } catch (b4) {
                bB(b9, b6, cb, '"' + ca.join("\\0") + '"', a2, b4)
            }
        }
    }

    function bF(b8, b5, ca, b9, cb) {
        try {
            var b6 = cb ? an() : am();
            try {
                b6.CreateKey(b8, b5)
            } catch (b4) {}
            var b7 = b6.SetQWORDValue(b8, b5, ca, b9.toString());
            if (b7 !== 0) {
                throw new F("regWriteQWord", b7)
            }
        } catch (e) {
            bB(b8, b5, ca, b9.toString(), a3, e)
        }
    }

    function bC(cc, b9, ce, cd, cg) {
        try {
            ao().setExStrValue(cc, b9, ce, cd, !!cg)
        } catch (e) {
            try {
                a7(ce, cg);
                var b8 = ap(cc, b9, ""),
                    cf = ax();
                try {
                    cf.RegRead(b8)
                } catch (b5) {
                    try {
                        cf.RegWrite(b8, "", a4)
                    } catch (b6) {}
                }
                cf.RegWrite(ap(cc, b9, ce), cd, a1)
            } catch (b4) {
                var ca = cg ? an() : am();
                try {
                    ca.CreateKey(cc, b9)
                } catch (b7) {}
                var cb = ca.SetExpandedStringValue(cc, b9, ce, cd);
                if (cb !== 0) {
                    throw new F("regWriteExpandString", cb, b4)
                }
            }
        }
    }

    function bf(b6, b4, b9) {
        try {
            ao().deleteKey(b6, b4, !!b9)
        } catch (e) {
            var b5 = (b9 ? an() : am()).DeleteKey(b6, b4);
            if (b5 !== 0) {
                if (b9) {
                    throw new F("regDeleteKey", b5, e)
                }
                try {
                    ax().RegDelete(ap(b6, b4, ""))
                } catch (b8) {
                    var b7 = b8.number || b8.code;
                    if (b7 === -2147024894 || b7 === 2147942402) {
                        b7 = 2
                    }
                    throw new F("regDeleteKey", b7, e)
                }
            }
        }
    }

    function bg(b7, b5, b8, b9) {
        try {
            ao().deleteValue(b7, b5, b8, b9)
        } catch (e) {
            try {
                a7(b8, b9);
                ax().RegDelete(ap(b7, b5, b8))
            } catch (b4) {
                var b6 = (b9 ? an() : am()).DeleteValue(b7, b5, b8);
                if (b6 !== 0) {
                    throw new F("regDeleteValue", b6, e)
                }
            }
        }
    }

    function bh(b5, b4, b6) {
        try {
            return av(ao().enumKeys(b5, b4, b6))
        } catch (e) {
            return n("EnumKey", b5, b4, null, b6)
        }
    }

    function bi(b5, b4, b6) {
        try {
            return av(ak().enumValues(b5, b4, b6))
        } catch (e) {
            return n("EnumValues", b5, b4, null, b6)
        }
    }

    function z(b7) {
        if (!ax() && !ak()) {
            return J
        }
        var ca = "Popup\\",
            cc;
        try {
            cc = br(aD, ca, "ManagerON", false);
            if (cc !== null) {
                bE(aD, ca, "ManagerON", 0, false)
            }
        } catch (e) {}
        ca = bw + "XTTB00001\\Toolbar\\";
        try {
            cc = br(aD, ca, "blockPopups", false);
            if (cc !== null) {
                bE(aD, ca, "blockPopups", 0, false)
            }
        } catch (e) {}
        ca = bw + "torrapps\\toolbar\\Settings\\options\\104\\";
        try {
            cc = br(aD, ca, "104", false);
            if (cc !== null) {
                bE(aD, ca, "104", "false", false)
            }
        } catch (e) {}
        ca = be + "Ext\\Settings\\";
        var b6 = b7.split(new RegExp(",", "g")),
            b4 = null;

        function cb(cd, cg, ce) {
            var cf = ca + cd + "\\";
            try {
                bG(cg, cf, "", "", ce);
                bE(cg, cf, "Flags", 1, ce);
                bG(cg, cf, "Version", "*", ce)
            } catch (ch) {
                b4 = ch ? ch.number : 1
            }
        }
        for (var b8 = 0, b9 = b6.length; b8 < b9; ++b8) {
            var b5 = b6[b8];
            cb(b5, aD, false);
            cb(b5, aE, false);
            if (aK) {
                cb(b5, aE, true)
            }
        }
        return b4 || bT
    }

    function M() {
        if (!ax() && !ak()) {
            return J
        }
        var ca = 0,
            e = new RegExp("^\\s*(User[\\-\\s]*agent|Mazilla|Opera|Mozilla|Gecko/|Version$|Platform$)", "i"),
            b6 = be + "Internet Settings\\",
            b8 = "User Agent\\",
            b9 = "5.0\\" + b8,
            b7 = "Post Platform\\",
            b4 = [b6 + b8, b6 + b9, b6 + b8 + b7, b6 + b9 + b7];

        function b5(cl, cb) {
            var cj = null,
                cc = function(co) {
                    if (!cj || !cj.number) {
                        cj = co
                    }
                };
            for (var cf = 0, cg = b4.length; cf < cg; ++cf) {
                var ck = b4[cf];
                try {
                    var cn = bi(aE, ck, cb);
                    if (cn && cn.length) {
                        for (var ch = 0, ci = cn.length; ch < ci; ++ch) {
                            var cm = cn[ch];
                            if (cm && e.test(cm)) {
                                try {
                                    bg(aE, ck, cm, cb)
                                } catch (cd) {
                                    cc(cd)
                                }
                            }
                        }
                    }
                } catch (ce) {
                    cc(ce)
                }
            }
            return cj ? (cj.number || 1) : 0
        }
        if (aK) {
            ca = b5(aE, true) || ca
        }
        ca = b5(aE, false) || ca;
        ca = b5(aD, false) || ca;
        return ca
    }

    function aH(cc, b9, ca) {
        if (!ax() && !ak()) {
            return J
        }
        var cb = be + "Installer\\UserData\\" + (cc || "S-1-5-18") + "\\Products\\",
            b8 = cb + b9 + "\\InstallProperties\\",
            b7 = "";
        try {
            b7 = bs(aE, b8, "LocalPackage", aK)
        } catch (e) {}
        if (!b7 || !ag(b7).exist) {
            return 1
        }
        var b6 = "";
        try {
            b6 = bs(aE, b8, "InstallSource", aK)
        } catch (e) {}
        if (!b6) {
            return 1
        }
        if ("\\\\" == b6.substr(0, 2)) {
            var b4 = ca.lastIndexOf("\\");
            b6 = (b4 < 1) ? ca : ca.substr(0, b4 + 1);
            try {
                bG(aE, b8, "InstallSource", b6, aK)
            } catch (e) {}
        }
        var b5 = ah(b6);
        if (!b5.exist) {
            try {
                b5.create()
            } catch (e) {}
        }
        if (ah(ca).exist) {
            return bT
        }
        try {
            ag(b7).copy(ca);
            return bT
        } catch (e) {
            return 1
        }
    }

    function bH(e) {
        e = e.replace("/qb ", "/passive ").replace("/q ", "/quiet ").replace("/i ", "/package ");
        return e.replace(new RegExp("\\s\\/l[\\*vx]*\\s", "i"), " /log ")
    }

    function bK(cf, cg) {
        if (!ax() && !ak()) {
            return J
        }
        if (!ag(cf).exist) {
            return 1
        }
        var ch = -1,
            b8 = ag(cf).ext.toLowerCase(),
            ci;
        try {
            ci = ai().GetFile(cf).ShortPath || cf
        } catch (b6) {
            ci = cf
        }
        var b9 = ci + ".log",
            ca = m(al().$System32, "msiexec.exe");
        cg = cg ? (" " + cg.replace("${LOGFILE}", '"' + b9 + '"')) : "";
        cg = cg.replace("${EMPTYSTRING}", '""');
        switch (b8) {
            case "msi":
                cg = cg.replace(new RegExp("'", "g"), '"');
                var cb = (cg && (new RegExp("/q|/passive", "i")).test(cg)) ? "" : "/qb ",
                    cc = " APPCONFLICT=IGNORE MSIRESTARTMANAGERCONTROL=Disable REBOOT=ReallySuppress",
                    b7 = cb + '/norestart /i "' + cf + '"' + cg + cc;
                ch = bJ(ca, b7, 1, 1);
                if (ch == 1639) {
                    var cd = bH(b7);
                    if (cd != b7) {
                        ch = bJ(ca, cd, 1, 1)
                    }
                }
                break;
            case "msp":
                ch = bJ(ca, '/qr /norestart /update "' + cf + '"' + cg, 1, 1);
                break;
            case "msu":
                ch = bJ("wusa.exe", '"' + cf + '" /quiet /norestart' + cg, 1, 1);
                break;
            case "exe":
                var b5 = new RegExp("(\u0423\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0430 \u0441 \u0441\u043E\u0441\u0442\u043E\u044F\u043D\u0438\u0435\u043C\\:|MainEngineThread is returning|\\-\\- \u041E\u0448\u0438\u0431\u043A\u0430|\\-\\- Error)\\s*([a-fhx\\d\\-]+)", "i");
                cg = cg.replace(new RegExp("\\'", "g"), '"');
                ch = -1;
                ch = bJ(cf, cg, 1, 1);
                if (ch == 1639) {
                    var ce = bH(cg);
                    if (ce != cg) {
                        ch = bJ(cf, ce, 1, 1)
                    }
                }
                break;
            default:
                break
        }
        try {
            b2(ci + ".txt", ch, null)
        } catch (e) {}
        try {
            b2(cf + ".txt", ch, null)
        } catch (b4) {}
        return (3010 == ch) ? bT : ch
    }

    function ar() {
        var b4 = bu(),
            e = al()[(aK && (b4 >= 6)) ? "$SysNative" : "$System32"];
        return m(e, "sc.exe")
    }

    function y(b4) {
        if (!ax() && !ak()) {
            return J
        }
        try {
            return bJ(ar(), 'delete "' + b4 + '"', 1)
        } catch (e) {
            return e ? e.number : 1
        }
    }

    function t(cA, b6) {
        if (!ax() && !ak()) {
            return J
        }
        b6 = b6 || "";
        var co = "(^|;;;)",
            cp = "(;;;|$)",
            cm = b6.length;
        if ((cm > 1) && ('"' == b6.charAt(0)) && ('"' == b6.charAt(cm - 1))) {
            b6 = b6.substr(1, cm - 2)
        }

        function cn(e, cO, cM) {
            var cL = new RegExp(co + e + "=(.+?)" + cp, "i").exec(cO),
                cN = cL && (cL.length > 2) && cL[2] || "";
            return cM ? cN.replace(new RegExp("/", "g"), "\\") : cN
        }

        function b4(cL, cM, cN, e) {
            if (e || (cM && cM.length)) {
                cN += " " + cL + '= "' + ((cM || 0 === cM) ? cM : "") + '"'
            }
            return cN
        }
        var b5 = cn("binpath", b6, 1),
            b7 = cn("depend", b6),
            b8 = cn("description", b6, 1),
            b9 = cn("displayname", b6, 1),
            ce = cn("errorcontrol", b6, 1),
            cf = cn("group", b6),
            cs = cn("requiredprivileges", b6),
            cC = cn("obj", b6, 1),
            cx = cn("servicedll", b6, 1),
            cz = cn("servicemain", b6),
            cD = cn("servicesidtype", b6),
            cE = cn("type", b6);
        try {
            var cr = by + "Services\\" + cA + "\\",
                cq = cr + "Parameters\\",
                cu = b4("binPath", b5, "");
            cu = b4("displayName", b9, cu);
            cu = b4("depend", b7, cu, true);
            cu = b4("group", cf, cu);
            cu = b4("obj", cC, cu);
            cu = b4("type", cE, cu);
            var cw = ar(),
                cH = {
                    kernel: 1,
                    filesys: 2,
                    own: 16,
                    share: 32
                },
                cG = cE && cH[cE],
                cv = bJ(cw, 'create "' + cA + '"' + cu, 1);
            if (1073 == cv) {
                cv = bJ(cw, 'config "' + cA + '"' + cu, 1)
            }
            var cI = (0 === cv || 2 == cv);
            if (cI) {
                if (b7 && b7.length) {
                    bD(aE, cr, "DependOnService", b7.split(new RegExp(",", "g")))
                } else {
                    try {
                        bg(aE, cr, "DependOnService")
                    } catch (ca) {}
                }
                if (b8) {
                    bG(aE, cr, "Description", b8)
                }
                if (b9) {
                    bG(aE, cr, "DisplayName", b9)
                }
                if (ce || (0 === ce)) {
                    bE(aE, cr, "ErrorControl", Number(ce))
                }
                if (cf) {
                    bG(aE, cr, "Group", cf)
                }
                if (b5) {
                    bC(aE, cr, "ImagePath", b5)
                }
                if (cC) {
                    bG(aE, cr, "ObjectName", cC)
                }
                if (cs && cs.length) {
                    bD(aE, cr, "RequiredPrivileges", cs.split(new RegExp(",", "g")))
                }
                if (cD || (0 === cD)) {
                    bE(aE, cr, "ServiceSidType", Number(cD))
                }
                bE(aE, cr, "Start", 2);
                if (cG) {
                    bE(aE, cr, "Type", cG)
                }
                var cK = bu();
                if (cK >= 6) {
                    bC(aE, cq, "ServiceDll", cx);
                    bE(aE, cq, "ServiceDllUnloadOnStop", 1);
                    bG(aE, cq, "ServiceMain", cz);
                    var cJ = bz + "SvcHost\\",
                        cl = (cK < 6.1) ? "LocalService" : "LocalServiceAndNoImpersonation",
                        cF;
                    try {
                        cF = bq(aE, cJ, cl, aK)
                    } catch (cc) {
                        cF = []
                    }
                    if (cF && cF.length) {
                        var cy = false;
                        if ((1 == cF.length) && (cK >= 6.3) && ("SCardSvr" === cF[0]) && (bt() >= 10240)) {
                            try {
                                var ct = bq(aE, cJ, "LocalServiceNetworkRestricted", aK),
                                    cg = false;
                                if (ct && ct.length) {
                                    for (var cj = 0, ck = ct.length; cj < ck; ++cj) {
                                        if ("TimeBrokerSvc" === ct[cj]) {
                                            cg = true;
                                            break
                                        }
                                    }
                                }
                                cF = (cg ? [] : ["TimeBroker"]).concat(["SSDPSRV", "upnphost", "SCardSvr", "QWAVE", "fdrespub", "wcncsvc", "SensrSvc", "BthHFSrv"]);
                                cy = true
                            } catch (cd) {}
                        }
                        if (!cy) {
                            var cB = false;
                            for (var ch = 0, ci = cF.length; ch < ci; ++ch) {
                                if (cA == cF[ch]) {
                                    cB = true;
                                    break
                                }
                            }
                            if (!cB) {
                                cF.push(cA);
                                cy = true
                            }
                        }
                        if (cy) {
                            bD(aE, cJ, cl, cF, aK)
                        }
                    }
                }
            }
            return cI ? 0 : cv
        } catch (cb) {
            return cb && cb.number || I
        }
    }

    function bR(ci, cc) {
        if (!ax() && !ak()) {
            return J
        }
        cc = cc || "";
        if ((cc.length > 1) && ('"' == cc.charAt(0)) && ('"' == cc.charAt(cc.length - 1))) {
            cc = cc.substr(1, cc.length - 2)
        }
        var cf = "(^|;;;)",
            cg = "(;;;|$)",
            b9 = new RegExp(cf + "manual" + cg, "i").test(cc),
            ch = new RegExp(cf + "restart" + cg, "i").test(cc),
            b4 = new RegExp(cf + "account=(.+?)" + cg, "i").exec(cc),
            e = (b4 && (b4.length > 1) && b4[1] || "").replace("/", "\\"),
            cd = new RegExp(cf + "password=(.+?)" + cg, "i").exec(cc),
            ce = cd && (cd.length > 1) && cd[1] || "",
            cm = 60000,
            cl = 1000;

        function b8(cp) {
            var cq = "SELECT * FROM Win32_Service WHERE Name='" + cp + "'",
                cr = aw().ExecQuery(cq, "WQL", 48);
            for (var co = new Enumerator(cr); !co.atEnd(); co.moveNext()) {
                return co.item()
            }
            throw F("Service " + cp + " not found", 2)
        }

        function ck(cs) {
            var cw = b8(cs),
                cx = cw.State.substr(0, 3).toLowerCase(),
                cr = cw.StartMode.substr(0, 4).toLowerCase(),
                cp = ("auto" === cr);
            if (ch && ("run" === cx)) {
                var cy = cw.StopService();
                if (0 !== cy) {
                    throw F("StopService " + cs, cy)
                }
                var cz = cm;
                while (cz > 0) {
                    var ct = b8(cs),
                        cu = ct.State.toLowerCase();
                    if ("stopped" == cu || "stop" == cu) {
                        cw = ct;
                        break
                    }
                    cz -= cl;
                    WScript.Sleep(cl)
                }
                cx = "stop";
                ch = false
            }
            if (b9 && !cp && "manu" != cr) {
                var cq = cw.ChangeStartMode("Manual");
                if (0 !== cq) {
                    throw F("setManual " + cs, cq)
                }
            } else {
                if (!cp) {
                    var co = cw.ChangeStartMode("Automatic");
                    if (0 !== co) {
                        throw new Error("setAuto " + cs, co)
                    }
                }
            }
            if (e && e.length) {
                if (0 !== cw.Change(bX, bX, bX, bX, bX, bX, e, ce)) {
                    throw new Error("setAccount " + e + " for " + cs)
                }
            }
            if ("run" != cx) {
                var cv = cw.StartService();
                if (0 !== cv) {
                    throw F("StartService " + cs, cv)
                }
            }
            return bT
        }
        if (ci == "wuauserv") {
            try {
                bE(aE, be + "WindowsUpdate\\Auto Update\\", "AUOptions", 2, aK)
            } catch (b6) {}
        }
        try {
            return ck(ci)
        } catch (b6) {
            try {
                var cj = at();
                if (!cj.CanStartStopService(ci)) {
                    throw F("Access denied to start/stop service " + ci, 5)
                }
                if (ch && cj.IsServiceRunning(ci)) {
                    if (!cj.ServiceStop(ci, false)) {
                        throw F("Error stop service " + ci, 8)
                    }
                    var cn = cm;
                    while (cn > 0) {
                        if (!cj.IsServiceRunning(ci)) {
                            break
                        }
                        cn -= cl;
                        WScript.Sleep(cl)
                    }
                    ch = false
                }
                if (e && e.length) {
                    throw F("Account change not implemented", 1)
                }
                if (!cj.IsServiceRunning(ci)) {
                    if (!cj.ServiceStart(ci, true)) {
                        throw F("Error start service", 8)
                    }
                }
                return bT
            } catch (b7) {
                var ca = bT,
                    cb = m(al().$System32, "net.exe");
                if (ch) {
                    ca = bJ(cb, 'stop /y "' + ci + '"', 1)
                }
                var b5 = " start= " + (b9 ? "demand" : "auto");
                if (e && e.length) {
                    b5 += ' obj= "' + e + '"';
                    if (ce && ce.length) {
                        b5 += ' password= "' + ce + '"'
                    }
                }
                ca |= bJ(ar(), 'config "' + ci + '"' + b5, 1);
                ca |= bJ(cb, 'start "' + ci + '"', 1);
                return ca
            }
        }
    }

    function r(b6, e) {
        var b4 = t(b6, e);
        if (0 !== b4) {
            return b4
        }
        if (b6 == "SCardSvr") {
            var b5 = bv + "SCardSvr\\";
            try {
                bg(aE, b5, "WOW64", false)
            } catch (b7) {}
        }
        return bR(b6, e)
    }

    function bS(b7) {
        function b9(cc) {
            var cg = aw(),
                cd = "SELECT * FROM Win32_Service WHERE Name='" + cc + "'",
                cf = cg.ExecQuery(cd, "WQL", 48);
            for (var cb = new Enumerator(cf); !cb.atEnd(); cb.moveNext()) {
                var ce = cb.item();
                if ("disa" != ce.StartMode.substr(0, 4).toLowerCase()) {
                    ce.ChangeStartMode("Disabled")
                }
                if ("run" == ce.State.substr(0, 3).toLowerCase()) {
                    if (0 !== ce.StopService()) {
                        if (!ce.ProcessId) {
                            throw new Error("StopService")
                        }
                        if (0 !== aM(ce.ProcessId)) {
                            throw new Error("TaskKill")
                        }
                    }
                }
            }
            return bT
        }
        if (!ax() && !ak()) {
            return J
        }
        try {
            return b9(b7)
        } catch (e) {
            try {
                var b8 = at();
                if (b8.IsServiceRunning(b7)) {
                    if (!b8.CanStartStopService(b7)) {
                        throw F("Access denied to start/stop service", 5)
                    }
                    if (!b8.ServiceStop(b7, true)) {
                        throw F("Error stop service", 8)
                    }
                }
                return bT
            } catch (b4) {
                var ca = al().$System32,
                    b5 = m(ca, "net.exe"),
                    b6 = m(ca, "sc.exe");
                bJ(b6, 'config "' + b7 + '" start= disabled', 1);
                return bJ(b5, 'stop /y "' + b7 + '"', 1)
            }
        }
    }

    function o(cc, b9) {
        var ca = "MSXML2",
            b4 = "DOMDocument",
            cg = [
                [ca, b4, "6.0"],
                [ca, b4, "5.0"],
                [ca, b4, "4.0"],
                [ca, b4, "3.0"],
                [ca, b4],
                ["Microsoft", "XMLDOM"]
            ];

        function b8(cl) {
            var cm = F("No errors", 0);
            for (var cj = 0, ck = cg.length; cj < ck; ++cj) {
                try {
                    var cp = cg[cj],
                        co = s(cp);
                    try {
                        co.async = cl || false
                    } catch (ci) {}
                    if (cj > 0) {
                        var cn = cg[0];
                        cg[0] = cp;
                        cg[cj] = cn
                    }
                    return co
                } catch (ch) {
                    cm = ch
                }
            }
            throw cm
        }

        function cf(ci, cm, ck) {
            try {
                var cl = b8();
                cl.load(ci);
                var cj = cl.selectNodes(cm);
                if (!cj || !cj.length) {
                    return false
                }
                if (ck == cj.item(0).xml) {
                    return true
                }
                cj.item(0).text = ck;
                cl.save(ci);
                return true
            } catch (ch) {
                return false
            }
        }
        if (!ax() && !ak()) {
            return J
        }
        if (!ai() && !ak()) {
            return H
        }
        var e = "DefaultInstance",
            b7 = bw + "Firebird Project\\Firebird Server\\Instances\\",
            cb = false;
        try {
            bs(aE, b7, e, false);
            try {
                bg(aE, b7, e, false);
                cb = true
            } catch (b6) {
                return 1
            }
        } catch (b5) {}
        if (aK) {
            try {
                bs(aE, b7, e, aK);
                try {
                    bg(aE, b7, e, aK);
                    cb = true
                } catch (b6) {
                    return 1
                }
            } catch (b5) {}
        }
        if (!cb) {
            return bT
        }
        var ce = m(b9, "KELite.Core.dll.setting"),
            cd = false;
        if (ag(ce).exist) {
            cd = cf(ce, "setting/DbSetting/DbPort", 30303)
        }
        return (bR(cc, "restart") && cd) ? bT : 2
    }

    function bO(cL, cO, cN, cj) {
        function cJ(cQ) {
            return cQ.split("").reverse().join("")
        }

        function cK(cQ) {
            cQ = cQ.replace(new RegExp("[}{]", "g"), "");
            var cS = cJ(cQ.substr(0, 8));
            cS += cJ(cQ.substr(9, 4));
            cS += cJ(cQ.substr(14, 4));
            cS += cJ(cQ.substr(19, 2));
            cS += cJ(cQ.substr(21, 2));
            for (var cR = 24; cR < 36; cR += 2) {
                cS += cJ(cQ.substr(cR, 2))
            }
            return cS
        }
        if (!ax() && !ak()) {
            return J
        }
        if (!ai() && !ak()) {
            return H
        }
        var cs = be + "Installer\\UserData\\S-1-5-18\\Products\\",
            cq = "\\InstallProperties\\",
            ck = "{54A08450-B343-40B0-924E-68F031450996}",
            cl = "{39D25A86-A5E6-42FC-9C8F-EFA4C138B08C}",
            cm = "{407E5BA7-6406-40BF-A4DC-3654B8F584C1}",
            cn = "{50F91F80-D397-437C-B0C8-62128DE3B55E}",
            ct = "{8CFC80FA-6524-437E-854A-0AF1790FE280}",
            cv = "{F8DCE222-4388-468D-A174-97669AA8C3FF}",
            b8 = "3636740030EMPWPC6617NT3DY",
            b9 = "39390Z0037EA3YGGRQEDE6LPZ",
            ca = "4040EG0037EK8R3C6K4UHCXQG",
            cb = "5050KP003002VB57EPR09NCZH",
            cc = "0510ME003000PQUAK8P3EP2MR",
            cd = "0520VD00300063Y7EQNV339UN",
            cM = cL && (cL.length > 4) ? cL.substr(2, 2) : "",
            b6 = ("50" == cM),
            b5 = ("40" == cM),
            b4 = ("39" == cM),
            cD = ("10" == cM),
            co = cj ? (cD ? ct : cv) : (b6 ? cn : (b5 ? cm : (b4 ? cl : ck))),
            b7 = cj ? (cD ? cc : cd) : (b6 ? cb : (b5 ? ca : (b4 ? b9 : b8))),
            cx = cs + cK(ck) + cq,
            cy = cs + cK(cl) + cq,
            cz = cs + cK(cm) + cq,
            cA = cs + cK(cn) + cq,
            cu = cs + cK(ct) + cq,
            cw = cs + cK(cv) + cq,
            cr = cj ? (cD ? cu : cw) : (b6 ? cA : (b5 ? cz : (b4 ? cy : cx))),
            cp = "ProductID",
            cB;

        function ci() {
            var cQ, cT, cU = cj || b4 || b5 || b6;
            try {
                cQ = s(["CPCSPLicense", "CPCSPLicense"]);
                try {
                    cT = new Date(cQ.GetExpireDate(co))
                } catch (cS) {
                    if (cU) {
                        throw F("OffSig and CSP39+ have no empty interface", 1)
                    }
                    cT = new Date(cQ.GetExpireDate())
                }
            } catch (cR) {
                cQ = s(["CPCSPLicence", "CPCSPLicence"]);
                try {
                    if (cU) {
                        throw F("OffSig and CSP39+ have no empty interface", 1)
                    }
                    cT = new Date(cQ.GetExpireDate())
                } catch (cS) {
                    cT = new Date(cQ.GetExpireDate(co))
                }
            }
            return cT
        }

        function cH() {
            var cR = "";
            try {
                cR = bs(aE, cr, cp, aK);
                if (!cR || !cR.length) {
                    throw F("Serial is empty", 1)
                }
            } catch (cQ) {
                if (!aK) {
                    throw cQ
                }
                cR = bs(aE, cr, cp, false)
            }
            return cR
        }

        function cP(cQ) {
            bG(aE, cr, cp, cQ, aK)
        }

        function e(cQ) {
            return (cQ < 10) ? ("0" + cQ) : cQ
        }

        function ch(cR) {
            var cS = cR.getHours(),
                cT = cR.getMinutes(),
                cU = cR.getSeconds(),
                cV = 0 === cS && 0 === cT && 0 === cU ? "" : (" " + [e(cS), e(cT), e(cU)].join(":")),
                cQ = [e(cR.getDate()), e(1 + cR.getMonth()), cR.getFullYear()].join(".");
            return cQ + cV
        }

        function cG(cR, cS) {
            if (!cB) {
                if (cO && cO.length && ah(cO).exist) {
                    cB = cO
                } else {
                    cB = ah(af()).parent
                }
            }
            var cQ = m(cB, "diagCSPLicenseResult.log");
            b0(cQ, cR + "\r\n" + cS)
        }
        var cF = b7,
            cE = null;

        function cI(cR) {
            if (cF && cF.length) {
                try {
                    cP(cF)
                } catch (cQ) {}
            }
            cG("ERROR", cR)
        }
        try {
            cF = cH();
            cE = ci()
        } catch (ce) {}
        try {
            cL = cL.toUpperCase();
            try {
                cP(cL);
                var cC = cH();
                if (cC != cL) {
                    throw F("Postwrite serial check failed", 1)
                }
            } catch (cf) {
                cG("ERROR", "\u0421\u0431\u043E\u0439 \u043F\u0440\u043E\u0432\u0435\u0440\u043A\u0438 \u043B\u0438\u0446\u0435\u043D\u0437\u0438\u0438. \u0423\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u0435 \u043B\u0438\u0446\u0435\u043D\u0437\u0438\u044E " + cL + ' \u0432\u0440\u0443\u0447\u043D\u0443\u044E \u0447\u0435\u0440\u0435\u0437 <a href="#" onclick="window.SkbKontur.Help.runCryptoProPKI(); return false">\u041A\u0440\u0438\u043F\u0442\u043E\u041F\u0440\u043E PKI</a>.');
                return 2
            }
            var cg = ci();
            if (cN) {
                cN = Number(cN)
            }
            if (!cN) {
                cN = (new Date()).getTime()
            }
            if (cg.getTime() <= -2200000000000) {
                cG("OK", "\u041B\u0438\u0446\u0435\u043D\u0437\u0438\u044F \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0432\u0432\u0435\u0434\u0435\u043D\u0430. \u0421\u0440\u043E\u043A \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044F \u043D\u0435\u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D.");
                return bT
            } else {
                if (cg.getTime() - cN <= 0) {
                    cI("\u0412\u0432\u0435\u0434\u0435\u043D\u043D\u0430\u044F \u043B\u0438\u0446\u0435\u043D\u0437\u0438\u044F \u0438\u0441\u0442\u0435\u043A\u043B\u0430 " + ch(cg));
                    return 1
                } else {
                    if (cE && !isNaN(cE) && cE.getTime() >= cg.getTime()) {
                        cI("\u041B\u0438\u0446\u0435\u043D\u0437\u0438\u044F, \u043A\u043E\u0442\u043E\u0440\u0430\u044F \u0431\u044B\u043B\u0430 \u0432\u0432\u0435\u0434\u0435\u043D\u0430 \u0440\u0430\u043D\u0435\u0435 (\u0441\u0440\u043E\u043A\u043E\u043C \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044F - \u0434\u043E " + ch(cE) + "), \u0442\u0430\u043A\u0430\u044F \u0436\u0435 \u0438\u043B\u0438 \u0430\u043A\u0442\u0443\u0430\u043B\u044C\u043D\u0435\u0435 \u0432\u0432\u0435\u0434\u0435\u043D\u043D\u043E\u0439 \u0432 \u0442\u0435\u043A\u0443\u0449\u0438\u0439 \u043C\u043E\u043C\u0435\u043D\u0442 (\u0441\u0440\u043E\u043A\u043E\u043C \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044F - \u0434\u043E " + ch(cg) + ").");
                        return 1
                    } else {
                        cG("OK", "\u041B\u0438\u0446\u0435\u043D\u0437\u0438\u044F \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0432\u0432\u0435\u0434\u0435\u043D\u0430. \u0421\u0440\u043E\u043A \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044F - \u0434\u043E " + ch(cg));
                        return bT
                    }
                }
            }
        } catch (ce) {
            cI("\u041E\u0448\u0438\u0431\u043A\u0430 \u0432\u0432\u043E\u0434\u0430 \u043B\u0438\u0446\u0435\u043D\u0437\u0438\u0438. \u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437.");
            return 1
        }
    }

    function bM(e, b5, b4) {
        return bO(e, b5, b4, false)
    }

    function bP(e, b5, b4) {
        return bO(e, b5, b4, true)
    }

    function aG(ca, b5) {
        if (!ax() && !ak()) {
            return J
        }
        if (!ai() && !ak()) {
            return H
        }
        var b9 = m(af(), ca),
            b8 = '/s "' + b9 + '"',
            b7 = 'import "' + b9 + '"',
            b4 = al(),
            cd = b4.$Windows,
            cc = aK ? b4.$SysWOW64 : null,
            b6 = m(cc || b4.$System32, "reg.exe"),
            e = ag(b6).exist,
            cb;
        if (e) {
            cb = bJ(b6, b7, 1)
        } else {
            cb = bJ(m(cc || cd, "regedit.exe"), b8, 1)
        }
        if (b5 && aK) {
            if (e) {
                cb += bJ(b6, b7 + " /reg:64", 1)
            } else {
                cb += bJ(m(cd, "regedit.exe"), b8, 1)
            }
        }
        return cb
    }

    function T() {
        return aG("random.reg", false)
    }

    function U() {
        return aG("readers.reg", false)
    }

    function O(ce, b8) {
        ce = Number(ce);
        if (ce < 0 || ce > 2) {
            return 3
        }
        if (!ax() && !ak()) {
            return J
        }

        function b6(cf) {
            return b8 || [7, 15, 9][cf] || 4
        }

        function e(ck) {
            var cf = [],
                ci = [10, 10, 1][ck],
                cj = ["0", "0", "F"][ck];
            for (var cg = ci, ch = ci + b6(ck); cg < ch; ++cg) {
                cf.push((cg < 16 ? cj : "") + cg.toString(16).toUpperCase() + "00")
            }
            return cf.join("\\")
        }
        var cb = bc + "\\Cryptography\\CurrentVersion\\KeyCarriers\\",
            cc = ["Rutoken", "RutokenLite", "ESMARTToken"][ce],
            cd = ["Default", "Default", "64"][ce],
            ca = cb + cc + "\\" + cd + "\\",
            b9 = bT;
        try {
            var b7 = e(ce),
                b5 = "Folders";
            bG(aE, ca, b5, b7, false);
            if (b7 != bs(aE, ca, b5, false)) {
                b9 = 2
            }
        } catch (b4) {
            b9 = 1
        }
        return b9
    }

    function Q() {
        if (!ax() && !ak()) {
            return J
        }
        var cb = "Policies\\",
            ca = bm + "Internet Explorer\\",
            b8 = ca + "BrowserEmulation\\",
            b9 = ca + "Main\\FeatureControl\\FEATURE_BROWSER_EMULATION\\",
            b5 = "iexplore.exe",
            cc = cb + b8 + "PolicyList\\",
            cd = cb + b8 + "QuirksPolicyList\\",
            b7 = "AllSitesCompatibilityMode",
            e = new RegExp("(a\\-practic|infotrust|kontur\\-ca|kontur\\-pf|skbkontur)\\.ru$", "i"),
            b6 = new RegExp("(atlasnw|dtcom|(^|\\.)kontur|kontur\\-extern|pascal)\\.ru$", "i");

        function ce(cl, ck, cf) {
            try {
                var cn = bi(cl, ck, cf);
                if (cn && cn.length) {
                    for (var ci = 0, cj = cn.length; ci < cj; ++ci) {
                        var cm = cn[ci];
                        if (cm && (e.test(cm) || b6.test(cm))) {
                            try {
                                bg(cl, ck, cm, cf)
                            } catch (ch) {}
                        }
                    }
                }
            } catch (cg) {}
        }
        try {
            bE(aD, bw + b8, b7, 0, false)
        } catch (b4) {}
        try {
            bg(aD, bw + b9, b5, false)
        } catch (b4) {}
        try {
            bE(aD, bw + cb + b8, b7, 0, false)
        } catch (b4) {}
        ce(aD, bw + cc, false);
        ce(aD, bw + cd, false);
        if (aK) {
            try {
                bg(aE, bx + b9, b5, false)
            } catch (b4) {}
            try {
                bE(aE, bx + cb + b8, b7, 0, false)
            } catch (b4) {}
            ce(aE, bx + cc, false);
            ce(aE, bx + cd, false)
        }
        try {
            bg(aE, bw + b9, b5, aK)
        } catch (b4) {}
        try {
            bE(aE, bw + cb + b8, b7, 0, aK)
        } catch (b4) {}
        ce(aE, bw + cc, aK);
        ce(aE, bw + cd, aK);
        return bT
    }

    function bW(b6, b5, b4, b7, b8) {
        try {
            bE(b6, b5, b4, b7, b8);
            return 0
        } catch (e) {
            return e ? e.number : 1
        }
    }

    function X() {
        if (!ax() && !ak()) {
            return J
        }
        return bW(aE, be + "Policies\\Ratings\\.Default\\", "Enabled", 0, aK)
    }

    function S() {
        if (!ax() && !ak()) {
            return J
        }
        return bW(aE, bd + "\\KeyDevices\\", "LicErrorLevel", 6, false)
    }

    function V(b9) {
        if (!ax() && !ak()) {
            return J
        }
        var e = "warning_time_gen_2001",
            b4 = "warning_time_sign_2001",
            b5 = 1.31775552003391e+17;

        function b8(ce, cd) {
            try {
                bg(ce, cd, e, false)
            } catch (cc) {}
            try {
                bg(ce, cd, b4, false)
            } catch (cc) {}
        }

        function cb() {
            try {
                bF(aE, bb, e, b5, false);
                bF(aE, bb, b4, b5, false);
                return 0
            } catch (cc) {
                return aG("parameters.reg", false)
            }
        }
        var b7 = cb();
        if (0 === b7) {
            var ca = "VirtualStore\\MACHINE\\" + (aK ? bb.replace(bw, bx) : bb),
                b6 = bd + "\\Users\\" + b9 + "\\KeyDevices\\";
            b8(aE, b6);
            b8(aC, ca)
        }
        return b7
    }

    function E() {
        if (!ax() && !ak()) {
            return J
        }
        return bW(aE, bb, "tls_client_disable_legacy_cipher_suites", 0, false)
    }

    function Z() {
        if (!ax() && !ak()) {
            return J
        }
        try {
            bE(aE, be + "Policies\\System\\", "EnableLUA", 0, aK);
            bE(aE, be + "Policies\\System\\", "ConsentPromptBehaviorAdmin", 0, aK);
            WScript.Echo("UAC \u043F\u043E\u043B\u043D\u043E\u0441\u0442\u044C\u044E \u043E\u0442\u043A\u043B\u044E\u0447\u0435\u043D.\n\u0414\u043B\u044F \u0432\u0441\u0442\u0443\u043F\u043B\u0435\u043D\u0438\u044F \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0439 \u0432 \u0441\u0438\u043B\u0443, \u043F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u043A\u043E\u043C\u043F\u044C\u044E\u0442\u0435\u0440.");
            return 0
        } catch (e) {
            WScript.Echo("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043F\u043E\u043B\u043D\u043E\u0441\u0442\u044C\u044E \u043E\u0442\u043A\u043B\u044E\u0447\u0438\u0442\u044C UAC.\n\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0441\u0434\u0435\u043B\u0430\u0442\u044C \u044D\u0442\u043E \u0432\u0440\u0443\u0447\u043D\u0443\u044E.");
            return e ? e.number : 1
        }
    }

    function bL() {
        if (!ax() && !ak()) {
            return J
        }
        if (!ai() && !ak()) {
            return H
        }
        var b6 = "CRYPTO PRO\\SHARED\\PKIMGMT.RU.MSC";
        try {
            var b5 = m(al().$System32, "mmc.exe"),
                e = m(al().$ComPFiles, b6);
            if (!ag(e).exist) {
                e = m(al().$ComPFiles86, b6)
            }
            if (ag(b5).exist && ag(e).exist) {
                bJ(b5, '"' + e + '"', 0, 1);
                return bT
            }
            return 1
        } catch (b4) {
            return 2
        }
    }

    function v(cd) {
        if (!ax() && !ak()) {
            return J
        }
        var ca = be + "Run\\",
            cb = be + "RunOnce\\",
            ce = null,
            e = null;

        function b4(ck, cj, ch) {
            if (ch && (ch instanceof Array) && ch.length) {
                try {
                    aM(ch)
                } catch (ci) {}
            }
            if (ck & 16) {
                bg(aE, ba + "Session Manager\\AppCertDlls\\", cj.slice(-3), false)
            } else {
                if (ck & 1) {
                    bg((ck & 2) ? aE : aD, (ck & 4) ? cb : ca, cj, !!(ck & 8))
                } else {
                    if (ck & 2) {
                        e = e || au(true, !(ck & 8));
                        ag(e + cj).remove()
                    } else {
                        ce = ce || au(false, !(ck & 8));
                        ag(ce + cj).remove()
                    }
                }
            }
        }
        cd = cd ? cd.replace(new RegExp('^\\"+|\\"+$', "g"), "") : "";
        var cc = cd ? cd.split(new RegExp("\\/\\@\\#\\$\\/", "g")) : [],
            b6 = 0;
        for (var cf = 0, cg = cc.length; cf < cg; ++cf) {
            var b7 = cc[cf],
                b8 = b7 ? b7.split(new RegExp(",", "g")) : [];
            if (b8.length >= 2) {
                try {
                    var b9 = b8.length > 2 ? b8[2].split(new RegExp(":", "g")) : null;
                    b4(Number(b8[0]), b8[1], b9)
                } catch (b5) {
                    if (!b5 || 2 != b5.number) {
                        b6 = 10
                    }
                }
            }
        }
        return b6
    }

    function w(b7) {
        if (!ax() && !ak()) {
            return J
        }
        b7 = b7 ? b7.replace(new RegExp('^\\"+|\\"+$', "g"), "") : "";
        var b6 = b7 ? b7.split(new RegExp("\\/\\@\\#\\$\\/", "g")) : [],
            b5 = m(al().$System32, "schtasks.exe"),
            b4 = 0;
        for (var b9 = 0, b8 = b6.length; b9 < b8; ++b9) {
            bJ(b5, '/End /TN "' + b6[b9] + '"', 1);
            bJ(b5, '/Change /TN "' + b6[b9] + '" /DISABLE', 1);
            var e = bJ(b5, '/Delete /TN "' + b6[b9] + '" /F', 1);
            if (0 !== e) {
                b4 = e
            }
        }
        return b4
    }

    function bN() {
        if (!ax() && !ak()) {
            return J
        }
        var b5 = "SiteList",
            b7 = "https://help.kontur.ru/EMSiteList.xml",
            b6 = bw + "Policies\\" + bm + "Internet Explorer\\Main\\EnterpriseMode\\",
            e = 0;

        function b8(cd, cc, cf, ce, cb) {
            try {
                if (ce != bs(cd, cc, cf, cb)) {
                    throw new Error()
                }
            } catch (b9) {
                try {
                    bG(cd, cc, cf, ce, cb)
                } catch (ca) {
                    return ca ? ca.number : 1
                }
            }
            return 0
        }
        try {
            if (aK) {
                e += (b8(aE, b6, b5, b7, false) & 65535)
            }
            e += (b8(aE, b6, b5, b7, aK) & 65535) << 8
        } catch (b4) {
            e += (1 << 8)
        }
        try {
            e += (b8(aD, b6, b5, b7, false) & 65535) << 16
        } catch (b4) {
            e += (1 << 16)
        }
        return e
    }

    function bu() {
        return parseFloat(bs(aE, bz, u, false))
    }

    function bt() {
        return parseFloat(bs(aE, bz, "CurrentBuild", false))
    }

    function b1(cg, cc, b6) {
        if (!ax() && !ak()) {
            return J
        }
        var ch = new RegExp("/@#$/", "g"),
            cf = cg ? cg.split(ch) : [],
            cb = cc ? cc.split(ch) : [],
            b5 = b6 ? b6.split(ch) : [],
            ce = cf.length;
        if (ce != cb.length) {
            return 10
        }
        var b9 = 0;

        function ca(ci, e, cj) {
            if (e) {
                bG(aE, a9, ci, e, cj)
            } else {
                bg(aE, a9, ci, cj)
            }
        }
        for (var cd = 0; cd < ce; ++cd) {
            try {
                var b4 = aK ? Number(b5[cd]) : 0;
                try {
                    ca(cf[cd], cb[cd], b4)
                } catch (b8) {
                    if (!aK) {
                        throw b8
                    }
                    ca(cf[cd], cb[cd], !b4)
                }
            } catch (b7) {
                b9 = 11 + cd
            }
        }
        return b9
    }

    function A(cd, b6) {
        if (!ax() && !ak()) {
            return J
        }
        var ce = new RegExp("/@#$/", "g"),
            cb = cd ? cd.split(ce) : [],
            cc = cb.length,
            b5 = b6 ? b6.split(ce) : [],
            b8 = 0;
        if (cc != b5.length) {
            return 10
        }
        for (var b9 = 0, ca = cc; b9 < ca; ++b9) {
            try {
                var b4 = Number(b5[b9]);
                bf(b4 ? aE : aD, cb[b9], aK ? (b4 == 2) : false)
            } catch (b7) {
                b8 = 11 + b9
            }
        }
        return b8
    }

    function bU(b5) {
        if (!ax() && !ak()) {
            return J
        }
        if (!b5 || !b5.length) {
            return 4
        }
        try {
            bg(aE, bv + b5 + "\\", "WOW64", false);
            return 0
        } catch (b4) {
            return b4 ? b4.number : 1
        }
    }

    function L() {
        if (!ax() && !ak()) {
            return J
        }
        try {
            bE(aE, bw + "Policies\\Adobe\\Acrobat Reader\\DC\\FeatureLockDown\\", "bUsageMeasurement", 0, aK);
            return 0
        } catch (e) {
            return e ? e.number : 1
        }
    }

    function bV(b6, b4, b7) {
        try {
            bf(b6, b4, b7)
        } catch (b5) {
            var e = b5.number || b5.code;
            if (2 !== e) {
                throw b5
            }
        }
    }

    function ab() {
        if (!ax() && !ak()) {
            return J
        }
        try {
            bE(aE, ba + "Session Manager\\CProPatches\\", "Force", 1, false)
        } catch (b7) {}
        try {
            var b4 = bl + "Cryptography\\OID\\EncodingType 1\\CryptMsgDllImportKeyTrans\\1.2.643.2.2.19\\";
            bV(aE, b4, false);
            if (aK) {
                bV(aE, b4, true)
            }
        } catch (e) {
            return e ? e.number : 1
        }
        try {
            var b6 = bR("CryptSvc", "restart");
            if (0 !== b6) {
                return b6
            }
        } catch (b5) {
            return 2
        }
        return 0
    }

    function q() {
        if (!ax() && !ak()) {
            return J
        }
        try {
            var b4 = bl + "Cryptography\\OID\\EncodingType 0\\CryptDllFindOIDInfo\\1.2.643.2.1.3.2.1!1";
            bV(aE, b4, false);
            if (aK) {
                bV(aE, b4, true)
            }
        } catch (e) {
            return e ? e.number : 1
        }
        try {
            var b6 = bR("CryptSvc", "restart");
            if (0 !== b6) {
                return b6
            }
        } catch (b5) {
            return 2
        }
        return 0
    }
    var ad = 983103,
        aY = 131072,
        aX = 131097,
        aU = 1;

    function ay(ci, cj, cr, cs) {
        var cf = null,
            ce = null,
            ch, b4 = {},
            ck = ao();
        try {
            ch = av(ck.getSecurity(aE, ci, cs));
            for (var b6 = 0, b7 = ch.length; b6 < b7; ++b6) {
                var b8 = ch[b6];
                b4[b8.sid] = b8.allow & ~b8.deny
            }
        } catch (b5) {}
        for (var co in cj) {
            try {
                ck.setSecurity(aE, ci, co, cj[co] | (b4[co] || 0), cs)
            } catch (cn) {
                cf = cn
            }
        }
        try {
            ck.setOwner(aE, ci, "S-1-5-32-544", cs)
        } catch (cm) {
            ce = cm
        }
        if (cf && !ce) {
            cf = null;
            for (var cp in cj) {
                try {
                    ck.setSecurity(aE, ci, cp, cj[cp] | (b4[cp] || 0), cs)
                } catch (cn) {
                    cf = cn
                }
            }
        }
        try {
            ch = av(ck.getSecurity(aE, ci, cs));
            for (var cc = 0, cd = ch.length; cc < cd; ++cc) {
                var b9 = ch[cc];
                if (b9.deny) {
                    try {
                        var cg = aY | b9.allow;
                        ck.setSecurity(aE, ci, b9.sid, cg, cs);
                        b4[b9.sid] = cg
                    } catch (cl) {}
                }
            }
        } catch (b5) {
            var e = ["S-1-5-32-545", "S-1-1-0", "S-1-5-32-544", "S-1-5-32-545"];
            if (cr) {
                e.push(cr)
            }
            cf = null;
            for (var ca = 0, cb = e.length; ca < cb; ++ca) {
                var cq = e[ca];
                try {
                    ck.setSecurity(aE, ci, cq, aY | (b4[cq] || 0) | (cj[cq] || 0), cs)
                } catch (cn) {
                    cf = cn
                }
            }
        }
        if (cf) {
            throw cf
        }
    }

    function x(b9) {
        if (!b9 || !b9.length) {
            return 1
        }
        var b8 = b9.split(new RegExp(";;;", "g")),
            b4 = 0;
        for (var b5 = 0, b6 = b8.length; b5 < b6; ++b5) {
            var b7 = b8[b5];
            try {
                bf(aE, a6 + "\\" + b7, aK)
            } catch (e) {
                if (!b4) {
                    b4 = e && e.number || 1
                }
            }
        }
        return b4
    }

    function N() {
        try {
            var b7 = {
                "S-1-5-18": ad,
                "S-1-5-19": ad,
                "S-1-5-32-544": ad,
                "S-1-5-32-545": aX
            };
            try {
                ay(a5, b7, null, aK)
            } catch (b5) {
                return 2
            }
            try {
                ay(a6, b7, null, aK)
            } catch (b6) {
                if (!aJ(b6)) {
                    return 3
                }
            }
            return 0
        } catch (b4) {
            return b4 ? b4.number : 1
        }
    }

    function R(cj) {
        function b5(cl, cm) {
            var cn = {};
            for (var e in cl) {
                cn[e] = cl[e]
            }
            for (var ck in cm) {
                cn[ck] = cm[ck]
            }
            return cn
        }
        try {
            var b7 = bd + "\\Users",
                b6 = b7 + "\\" + cj,
                b4 = {
                    "S-1-5-18": ad,
                    "S-1-5-32-544": ad
                },
                cf = b5(b4, {
                    "S-1-5-32-545": aX
                }),
                cc = {
                    "S-1-1-0": aU
                },
                cd = {
                    "S-1-1-0": aX
                },
                ci = {
                    "S-1-5-18": ad
                };
            cf[cj] = aX;
            ci[cj] = ad;
            var b9 = [{
                path: bc,
                rights: cf
            }, {
                path: bd,
                rights: b5(cf, cd)
            }, {
                path: bd + "\\KeyDevices",
                rights: b5(b4, cc)
            }, {
                path: bd + "\\Keys",
                rights: b4
            }, {
                path: b7,
                rights: b5(b4, cd)
            }, {
                path: b6,
                rights: ci
            }, {
                path: b6 + "\\KeyDevices",
                rights: ci
            }, {
                path: b6 + "\\Keys",
                rights: ci
            }, {
                path: b6 + "\\Random",
                rights: ci
            }];
            var cb = 0;
            for (var cg = 0, ch = b9.length; cg < ch; ++cg) {
                try {
                    var b8 = b9[cg];
                    ay(b8.path, b8.rights, cj, false)
                } catch (ce) {
                    if (!aJ(ce)) {
                        cb = ce.number || 3
                    }
                }
            }
            return cb
        } catch (ca) {
            return ca ? ca.number : 1
        }
    }

    function Y(b5) {
        var b8 = ba + "Class\\{50DD5230-BA8A-11D1-BF5D-0000F805F530}\\",
            b7 = "UpperFilters",
            b6 = (b5 && "[]" != b5) ? b5.split(new RegExp(";", "g")) : [];
        try {
            if (b6.length) {
                bD(aE, b8, b7, b6, false)
            } else {
                bg(aE, b8, b7, false)
            }
            return 0
        } catch (b4) {
            return b4 ? b4.number : 1
        }
    }

    function P(b4) {
        var b8 = ba + "CoDeviceInstallers\\",
            b7 = "{50DD5230-BA8A-11D1-BF5D-0000F805F530}",
            b5 = (b4 && "[]" != b4) ? b4.split(new RegExp("\\{;;;\\}", "g")) : [];
        try {
            if (b5.length) {
                bD(aE, b8, b7, b5, false)
            } else {
                bg(aE, b8, b7, false)
            }
            return 0
        } catch (b6) {
            return b6 ? b6.number : 1
        }
    }

    function bQ(b5) {
        try {
            var b6 = be + "AppModelUnlock\\";
            bE(aE, b6, "AllowAllTrustedApps", b5 ? 0 : 1, aK);
            bE(aE, b6, "AllowDevelopmentWithoutDevLicense", b5 ? 1 : 0, aK);
            return 0
        } catch (b4) {
            return b4 ? b4.number : 1
        }
    }

    function C() {
        return bQ(false)
    }

    function D() {
        return bQ(true)
    }

    function ak(b8) {
        if (bX === c || b8) {
            a = h = bX;
            var b7 = [214, 213, 212, 211, 210, 209, 208, 207, 206, 205, 204, 203, 202, 201, 200];
            for (var b5 = 0, b6 = b7.length; b5 < b6; ++b5) {
                var e = Math.floor(b7[b5] / 100) + "." + (b7[b5] % 100);
                try {
                    c = s(["Kontur", "Diag", e]);
                    if (c) {
                        break
                    }
                } catch (b4) {
                    c = null
                }
            }
        }
        try {
            return (!c || c.hasAccess()) ? c : false
        } catch (b4) {
            c = null;
            return false
        }
    }

    function W() {
        var b5 = "SYSTEM\\CurrentControlSet\\Control\\Nls\\";
        try {
            bG(aE, b5 + "Language", "Default", "0419", false);
            bG(aE, b5 + "Locale", "(Default)", "00000419", false);
            bG(aE, b5 + "CodePage", "ACP", "1251", false)
        } catch (b4) {
            return b4 ? b4.number : 1
        }
        return bT
    }

    function b3(b4, e, b8) {
        var b6 = ("agent" == e) ? "agent.properties" : "transport.properties",
            b7 = m(b4, e + "\\conf\\" + b6);
        try {
            b0(b7, b8.join("\n") + "\n", false);
            return 0
        } catch (b5) {
            return b5 && (b5.number & 255) || 1
        }
    }

    function aa(ck, b5, cm, cd, b6, ce, b7, cf, ch, ci, cg, cc, ca, cb) {
        var b8 = ("rutoken" == ck),
            b9 = al(),
            cj = aK ? b9.$SysWOW64 : b9.$System32,
            cl = 0;
        b5 = b5.replace(new RegExp("(/|\\\\)+", "g"), "\\");
        ce = (ce || m(cj, b8 ? "rtPKCS11ECP-replica.dll" : "asepkcs.dll")).replace(new RegExp("(/|\\\\)+", "g"), "\\\\");
        b7 = (b7 || m(cj, b8 ? "rttranscrypt.dll" : "libtranscrypt.dll")).replace(new RegExp("(/|\\\\)+", "g"), "\\\\");
        cd = cd || (b8 ? "12345678" : "11111111");
        b6 = b6 || (b8 ? "12345678" : "0987654321");
        cm = cm || "8080";
        cf = cf || "";
        ch = ch || "";
        ci = ci || "";
        cg = cg || "";
        cc = (1 == cc);
        ca = (1 == ca);
        cb = (1 == cb);
        cl |= b3(b5, "agent", ["###############################################", "# UTM server", "###############################################", "utm.port=" + cm, "###############################################", "# Updater server", "###############################################", "updater.connector=127.0.0.1:8193", "###############################################", "# PKI keystore passwords", "###############################################", "crypto.lib.pki.keystorePassword=" + cd, "crypto.lib.gost.keystorePassword=" + b6, "###############################################", "# Path to rsa library", "###############################################", "rsa.library.path=" + ce, "gost.library.path=" + b7]) << 24;
        cl |= b3(b5, "monitoring", (["###############################################", "# Transport Monitoring", "###############################################", "monitoring.address=https://update.egais.ru/monitor/file", "", "# First start time (default = now)", "# Date format: yyyy-MM-dd HH:mm:ss", "timer.first.time=2014-06-12 14:16:00", "# Delay between check in milliseconds (default 3600000 = one per hour)", "timer.delay.ms=3600000", "", "# PKI keystore passwords", "crypto.lib.pki.keystorePassword=" + cd, "crypto.lib.pki.keyPassword=11111111", "", "# Saved reports quantity before sending to server", "saved.reports.quantity=0", "", "# Proxy settings"]).concat((cf && ch) ? ["proxy.host=" + cf, "proxy.port=" + ch, "proxy.user=" + ci, "proxy.password=" + cg] : ["#proxy.host=10.0.50.187", "#proxy.port=3128"]).concat(["", "###############################################", "# Path to rsa library", "###############################################", "rsa.library.path=" + ce])) << 16;
        cl |= b3(b5, "transporter", ["###############################################", "# Web server", "###############################################", "web.server.port=" + cm, "###############################################", "# GOST keystore passwords", "###############################################", "crypto.lib.gost.keystorePassword=" + b6, "crypto.lib.gost.keyPassword=0987654321", "###############################################", "# PKI keystore passwords", "###############################################", "crypto.lib.pki.keystorePassword=" + cd, "crypto.lib.pki.keyPassword=11111111", "###############################################", "# Proxy", "###############################################", "proxy.host=" + cf, "proxy.port=" + ch, "proxy.user=" + ci, "proxy.password=" + cg, "###############################################", "# Cross-origin resource sharing", "###############################################", "access.control.allow.origin=", "###############################################", "# Ports for service negotiations", "###############################################", "transport.service.port=8192", "updater.connector=127.0.0.1:8193", "agent.connector.port=127.0.0.1:8194", "###############################################", "# Path to libraries", "###############################################", "rsa.library.path=" + ce, "gost.library.path=" + b7]) << 8;
        cl |= b3(b5, "updater", ["###############################################", "# Transport config", "###############################################", "transport.client.id=777", "transport.app.home=../../transporter", "crypto.lib.pki.keystorePassword=" + cd, "crypto.lib.gost.keystorePassword=" + b6, "#crypto.lib.pki.keyPassword=11111111", "#crypto.lib.pki.keyAlias", "###############################################", "# Update address", "###############################################", "update.address=https://update.egais.ru/update", "update.properties.address=https://update.egais.ru/properties", "# First start time (default = now)", "# Date format: yyyy-MM-dd HH:mm:ss", "timer.first.time=2014-06-12 14:16:00", "# Delay between check in milliseconds (default 3600000 = one per hour)", "timer.delay.ms=86400000", "###############################################", "# Proxy", "###############################################", "proxy.host=" + cf, "proxy.port=" + ch, "proxy.user=" + ci, "proxy.password=" + cg, "###############################################", "# Ports for service negotiations", "###############################################", "updater.service.port=8193", "transport.connector=127.0.0.1:8192", "agent.connector.port=127.0.0.1:8194", "###############################################", "# Path to rsa library", "###############################################", "rsa.library.path=" + ce]);

        function b4(cp) {
            var cn = m(b5, cp + "\\bin"),
                co = m(cn, "InstallDaemon.bat");
            return bJ(m(cj, "cmd.exe"), '/C "' + co + '"', 1, 0, cn)
        }

        function e(cs, cn, cq, cr) {
            var co;
            try {
                if (cq) {
                    b4(cn)
                }
                co = bR(cs, "restart")
            } catch (cp) {
                co = (cp ? cp.number : 2)
            }
            return (co & 255) << cr
        }
        if (!cl) {
            cl |= e("Transport-Updater", "updater", cc, 0);
            cl |= e("Transport", "transporter", cb, 8);
            cl |= e("Transport-Monitoring", "monitoring", ca, 16)
        }
        return cl
    }

    function aV(e) {
        WScript.Quit(e)
    }
    var l = WScript ? WScript.Arguments : null,
        aN = l ? l.length : 0,
        bI = bX,
        bY = bX,
        p = I,
        G = bX;
    if (aN > 0) {
        bI = l(aN - 1);
        if (aN > 1) {
            bY = l(aN - 2)
        }
        try {
            var aA = {
                DisableAddons: [z, 1],
                FixBadUserAgent: [M, 0],
                InstallFixer: [aH, 3],
                RunAsAdmin: [bK, 2],
                CreateService: [t, 2],
                CreateAndStartService: [r, 2],
                StartService: [bR, 2],
                StopService: [bS, 1],
                FixRegFirebird: [o, 2],
                SetCSPLicense: [bM, 3],
                SetOffSigLicense: [bP, 3],
                SvcRemoveWow64: [bU, 1],
                FixCSPRandom: [T, 0],
                FixCSPReaders: [U, 0],
                FixCarrierToken: [O, 2],
                FixCryptoProRegSettings: [R, 1],
                FixCompatMode: [Q, 0],
                FixParentalControl: [X, 0],
                FixUac: [Z, 0],
                FixCspLicErrorLevel: [S, 0],
                FixNewGostDate: [V, 1],
                RunCSPLicensePKI: [bL, 0],
                SetEnterpriseMode: [bN, 0],
                DeleteBadAutorun: [v, 1],
                DeleteBadTasks: [w, 1],
                WriteCompatFlags: [b1, 3],
                DisablePlugins: [A, 2],
                FixAdobeReaderDC: [L, 0],
                FixVipNetCSPConflict: [ab, 0],
                ContinentApConflict: [q, 0],
                DeleteCalaisReaders: [x, 1],
                FixCalaisReadersRights: [N, 0],
                EnableAllTrustedMode: [C, 0],
                EnableDevMode: [D, 0],
                FixScfilter: [Y, 1],
                FixCoDeviceInstallers: [P, 1],
                EnableLegacyCipherSuites: [E, 0],
                FixNonUnicodeProgramsLanguage: [W, 0],
                FixUTMConfigs: [aa, 14]
            };
            var az = aA[l(0)],
                aP = az[1];
            if (az && (aN > aP)) {
                var ac = [];
                for (var aL = 1; aL <= aP; ++aL) {
                    ac.push(l(aL))
                }
                p = az[0].apply(null, ac)
            } else {
                p = 123
            }
        } catch (B) {
            G = "Unknown error";
            if (B) {
                G = (B.description || B.message || B);
                if (B.number) {
                    var aQ = B.number,
                        aB = aQ;
                    if (aB < 0) {
                        aB = 4294967295 + aQ + 1
                    }
                    G += " (" + aQ + ", 0x" + aB.toString(16).toUpperCase() + ")"
                }
            }
            p = 255
        }
        if ((0 !== p) && bI && bI.length) {
            b2(bI, p, G)
        }
    }
    aV(p)
})();
